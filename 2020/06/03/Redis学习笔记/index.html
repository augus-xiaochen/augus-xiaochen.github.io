<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css">
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"8.0.0-rc.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="​        REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 ​        Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 ​        它通常被称为数据结构服务器，因为值（valu">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis学习笔记">
<meta property="og:url" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="晓晨の博客">
<meta property="og:description" content="​        REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 ​        Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 ​        它通常被称为数据结构服务器，因为值（valu">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image003.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image005.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image007.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image009.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image011.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image013.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image015.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image017.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image019.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image021.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image023.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image025.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image027.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image028.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image030.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image032.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image034.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image036.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image037.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image038.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image039.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image040.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image042.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image043.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image044.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image046.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image048.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image050.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image051.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image053.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image055.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image057.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image059.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image061.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image063.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image065.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image067.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image068.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image069.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image071.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image072.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image073.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image075.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image077.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image079.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image080.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image082.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image084.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image086.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image088.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image090.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image091.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image093.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image094.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image096.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image097.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image098.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image100.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image102.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image103.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image105.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image107.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image109.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image110.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image112.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image114.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image115.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image116.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image117.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image118.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image119.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image120.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image122.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image124.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image126.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image128.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image129.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image130.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image132.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image134.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image135.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image136.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image138.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image140.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image142.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image144.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image146.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image148.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image150.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image152.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image154.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image156.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image158.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image160.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image162.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image164.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image166.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image168.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image170.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image172.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image174.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image176.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image178.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image180.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image182.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image184.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image186.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image187.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image189.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image191.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image193.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image195.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image197.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image199.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image201.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image203.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image205.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image207.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image209.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image211.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image213.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image215.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image217.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image219.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image221.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image223.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image225.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image227.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image229.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image231.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image233.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image235.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image237.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image239.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image241.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image243.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image245.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image247.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image249.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image251.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image253.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image255.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image257.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image259.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image261.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image263.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image265.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image267.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image269.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image271.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image273.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image275.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image277.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image279.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image281.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image283.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image285.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image281.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image287.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image289.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image290.png">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image292.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image294.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image296.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image298.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image300.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image302.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image304.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image306.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image308.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image310.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image312.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image314.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image316.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image318.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image320.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image322.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image324.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image326.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image328.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image330.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image332.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image334.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image336.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image338.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image340.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image342.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image344.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image346.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image348.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image350.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image352.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image354.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image356.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image358.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image360.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image362.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image364.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image366.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image368.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image370.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image372.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image374.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image376.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image378.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image380.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image382.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image384.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image386.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image388.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image390.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image392.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image394.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image396.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image398.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image400.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image402.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image404.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image406.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image408.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image410.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image412.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image414.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image416.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image418.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image420.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image422.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image424.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image426.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image428.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image430.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image432.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image434.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image436.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image438.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image440.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image442.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image444.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image446.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image448.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image450.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image452.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image454.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image456.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image458.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image460.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image462.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image464.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image466.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image468.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image470.jpg">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif">
<meta property="og:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image471.gif">
<meta property="article:published_time" content="2020-06-03T04:03:49.000Z">
<meta property="article:modified_time" content="2020-06-03T04:05:06.128Z">
<meta property="article:author" content="晓晨">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image003.jpg">

<link rel="canonical" href="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Redis学习笔记 | 晓晨の博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">晓晨の博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">7</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="晓晨">
      <meta itemprop="description" content="乱世浮尘，不堪遥望，唯有情意，晨光依旧">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晓晨の博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Redis学习笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-03 12:03:49 / 修改时间：12:05:06" itemprop="dateCreated datePublished" datetime="2020-06-03T12:03:49+08:00">2020-06-03</time>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>​        REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。</p>
<p>​        Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
<p>​        它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Hash), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p>
<a id="more"></a>

<h1 id="Redis学习课程安排"><a href="#Redis学习课程安排" class="headerlink" title="Redis学习课程安排"></a>Redis学习课程安排</h1><p>l Redis基础—Windows环境学习</p>
<p>Ø Redis-入门</p>
<p>Ø 数据类型</p>
<p>Ø 通用命令</p>
<p>Ø Jedis</p>
<p>l Redis高级—Linux环境学习</p>
<p>Ø 持久化</p>
<p>Ø redis.conf</p>
<p>Ø 事务</p>
<p>Ø 集群</p>
<p>l Redis应用—Linux模拟真实生产环境学习</p>
<p>Ø 企业级解决方案</p>
<h1 id="第一部分：Redis基础"><a href="#第一部分：Redis基础" class="headerlink" title="第一部分：Redis基础"></a>第一部分：Redis基础</h1><h2 id="第一节：Redis入门"><a href="#第一节：Redis入门" class="headerlink" title="第一节：Redis入门"></a>第一节：Redis入门</h2><p>l 大量用户网站常见问题</p>
<p>Ø 问题现象：海量用户、高并发</p>
<p>Ø 罪魁祸首：关系型数据库</p>
<p>性能瓶颈：磁盘IO性能低下</p>
<p>扩展瓶颈：数据关系复杂，扩展性差，不便于大规模集群</p>
<p>Ø 解决思路：Nosql</p>
<p>降低磁盘IO次数，越低越好 —- 内存存储</p>
<p>去除数据间关系，越简单越好 —- 不存储关系，只存储数据  </p>
<p>l Nosql</p>
<p>NOSQL：即Not-OnlySQL（泛指非关系型的数据库），作为关系型数据库的补充。</p>
<p>作用：应对基于海量用户和海量数据前提下的数据处理问题</p>
<p>特征：</p>
<p>   可扩容、可伸缩</p>
<p>   大数据量下高性能</p>
<p>   灵活的数据模型</p>
<p>   高可用</p>
<p>l 常见的Nosql数据库</p>
<p>Redis、memcache、Hbase、MongoDB</p>
<p>l 解决方案（电商场景）</p>
<p>Ø 商品基本信息—MySQL</p>
<p>名称、价格、厂商</p>
<p>Ø 商品附加信息—MongoDB</p>
<p>描述、详情、评论</p>
<p>Ø 图片信息—分布式文件系统</p>
<p>Ø 搜索关键字—ES、Lucene、solr</p>
<p>Ø 热点信息—Redis</p>
<p>高频访问、波段性的内容；是非固定的东西，可能是以上信息的某一种</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image003.jpg" alt="img"></p>
<h3 id="1-1-Redis简介"><a href="#1-1-Redis简介" class="headerlink" title="1-1.    Redis简介"></a>1-1.    Redis简介</h3><p>概念：Redis（ REmote DIctionary Server#远程字典服务）是用C语言开发的—个开源的高性能键值对（key- value）数据库（本质）。</p>
<p>l 特征</p>
<p>Ø 数据间没有必然的关联关系</p>
<p>Ø 内部釆用单线程机制进行工作</p>
<p>Ø 高性能。官方提供测试数据，50个并发执行100000个请求读的速度是11000次/s写的速度是81000次/s</p>
<p>Ø 多数据类型支持</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 字符串类型string</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 列表类型list</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 散列类型hash</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 集合类型set有序集合类型sorted set</p>
<p>Ø 持久化支持：可以进行数据灾备恢复</p>
<p>l Redis的应用</p>
<p>Ø 为热点数据加速查询（主要场景），如热点商品、热点新闻、热点资讯、推广类等高访问量信息等</p>
<p>Ø 任务队列，如秒杀、抢购、购票排队等</p>
<p>Ø 即时信息查询，如各位排行榜、各类网站访问统计、公交到站信息、在线人数信息（聊天室、网站）、设备信号等</p>
<p>Ø 时效性信息控制，如验证码控制、投票控制等</p>
<p>Ø 分布式数据共享，如分布式集群架构中的 session分离</p>
<p>Ø 消息队列</p>
<p>Ø 分布式锁</p>
<h3 id="1-2-Redis部署"><a href="#1-2-Redis部署" class="headerlink" title="1-2.    Redis部署"></a>1-2.    Redis部署</h3><p>l Redis下载</p>
<p>Ø Linux版（适用于企业级开发）</p>
<p>Redis高级开始使用</p>
<p>以4.0版本作为主版本</p>
<p>Ø Windows版本（适合零基础学习）</p>
<p>Redis入门使用</p>
<p>以32版本作为主版本</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image005.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image007.jpg" alt="img"></p>
<h3 id="1-3-Redis基本操作"><a href="#1-3-Redis基本操作" class="headerlink" title="1-3.    Redis基本操作"></a>1-3.    Redis基本操作</h3><p>命令行模式工具使用思考</p>
<p>功能性命令</p>
<p>清除屏幕信息</p>
<p>帮助信息查阅</p>
<p>退出指令</p>
<p>l Redis基本操作指令</p>
<p>Ø 信息添加</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 功能：设置key、value数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令：set key value</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 范例：set name xiaochen</p>
<p>Ø 信息查询</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 功能：根据key查询对应的vaue，如果不存在，返回空（nil）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令：get key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 范例：get name</p>
<p>Ø 清除屏幕信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 功能：清除屏幕中的信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令：clear</p>
<p>Ø 帮助</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令：help 命令名称、help @组名</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image009.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image011.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image013.jpg" alt="img"></p>
<p>Ø 退出命令行客户端</p>
<p>quit、exit、<ESC>（仅限Windows）</ESC></p>
<h2 id="第二节：Redis数据类型"><a href="#第二节：Redis数据类型" class="headerlink" title="第二节：Redis数据类型"></a>第二节：Redis数据类型</h2><p>l 业务数据局的特殊性</p>
<p>Ø 作为缓存使用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 原始业务功能实际——秒杀、电商活动（618/双1111）、12306</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 运营平台监控到的突发高频访问数据——突然热点新闻</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 高频、复杂的统计数据——直播、在线投票</p>
<p>Ø 附加功能—系统功能优化或升级</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 单服务器升级集群</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> Session管理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> Token管理</p>
<p>l Redis五种常用数据类型</p>
<p>Ø string</p>
<p>Ø hash</p>
<p>Ø list</p>
<p>Ø set</p>
<p>Ø sorted_set</p>
<h3 id="2-1-Redis数据类型之string"><a href="#2-1-Redis数据类型之string" class="headerlink" title="2-1. Redis数据类型之string"></a>2-1. Redis数据类型之string</h3><p>redis数据存储格式：redis自身是一个Map，其中所有的数据都是采用key:value的形式存储</p>
<p>数据类型指的是存储的数据的类型，也就是 value部分的类型，key部分永远都是字符串</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image015.jpg" alt="img"></p>
<p>l string类型</p>
<p>Ø 存储的数据：单个数据，最简单的数据存储类型，也是最常用的数据存储类型</p>
<p>Ø 存储数据的格式：一个存储空间保存一个数据</p>
<p>Ø 存储内容：通常使用字符串，如果字符串以整数的形式展示，可以作为数字操作使用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image017.jpg" alt="img"></p>
<p>l string类型数据的基本操作</p>
<p>Ø 添加/修改数据：set key value</p>
<p>Ø 获取数据：get key</p>
<p>Ø 删除数据：del key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image019.jpg" alt="img"></p>
<p>Ø 添加/修改多个数据：mset <em>key1 value1 key2 value2</em> </p>
<p>##如果一个key被二次插入value，原始值将会被新值覆盖，例如：set a 1再次set a 2那么最终数据get a结果为2</p>
<p>Ø 获取多个数据：mget <em>key1 key2</em></p>
<p>Ø 获取数据字符个数（字符串长度）：strlen <em>key</em></p>
<p>Ø 追加信息到原始信息后部（如果原始信息存在就追加，否则新建）: append <em>key value</em></p>
<p>l set vs mset使用场景区分</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image021.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image023.jpg" alt="img"></p>
<p>l string类型数据的扩展操作</p>
<p>Ø 业务场景一：</p>
<p>大型企业级应用中，分表操作是基本操作，使用多张表存储同类型数据，但是对应的主键id必须保证统一性不能重复。 Orade数据库具有 sequence设定，可以解决该问题，但是 MySQL数据库并不具有类似的机制，那么如何解决？（可参考Mycat解决方案）</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设置数值数据增加指定范围的值</p>
<p>incr key ##每次执行+1 </p>
<p>incrby key increment ##指定key增加的数值</p>
<p>incrbyfloat key increment ##指定key增加的小数数值</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设置数值数减少指定范围的值</p>
<p>decr key</p>
<p>decrby key increment ##increment可以为正，也可以为负</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image025.jpg" alt="img"></p>
<p>Ø string作为数值操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> string在 redis内部存储默认就是一个字符串，当遇到缯减类操作incr,der时会转成数值型进行计算。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> redis所有的操作都是原子性的，采用单线程处理所有业务，命令是—个—一个执行的，因此无需考虑并发带来的数据影响。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 注意：按数值进行操作的数据，如果原始数据不能转成数值，或超越了 redis数值上限范围，将报错</p>
<p>9223372036854775807〔ava中long型数据最大值， Long. MAX VALUE）</p>
<p>## redis用于控制数据库表主键id，为数据库表主键提供生成策略，保障数据库表的主键唯一性（因为Redis所有操作都是原子性的）</p>
<p>##此方案适用于所有数据库，且支持数据库集群</p>
<p>###############################################################################</p>
<p>Ø 业务场景二：</p>
<p>“最强女生”启动海选投票，只能通过微信投票，每个微信号每4小时只能投1票。</p>
<p>电商商家开启热门商品推荐，热门商品不能直处于热门期，每种商品热门期维持3天，3天后自动取消热门。</p>
<p>新闻网站会出现热点新闻，热点新闻最大的特征是时效性，如何自动控空制热点新闻的时效性。</p>
<p>Ø 解决方案：设定数据具有指定的生命周期</p>
<p>setex <em>key seconds*（秒） *value</em></p>
<p>psetex <em>key milliseconds*（毫秒） *value</em></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image027.jpg" alt="img"></p>
<p>## redis控制数据的生命周期，通过数据是否失效控制业务行为，适用于所有具有时效性限定控制的操作</p>
<p>l string数据类型操作的注意事项</p>
<p>Ø 数据操作不成功的反馈与数据正常操作之间的差异</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 表示运行结果是否成功</p>
<p>（integer）0→ false失败</p>
<p>（integer）1→ true成功</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 表示运行结果值</p>
<p>（integer）3 → 3  3个</p>
<p>（integer）1 → 1  1个</p>
<p>Ø 数据未获取到</p>
<p>（nil）等同于null</p>
<p>Ø 数据最大存储量</p>
<p>512MB</p>
<p>Ø 数值计算最大范围l（java中的ong的最大值）</p>
<p>9223372036854775807</p>
<p>l string类型数据应用场景范例</p>
<p>主页高频访问信息显示控制，例如新浪微博大Ⅴ主页显示粉丝数与微博数量</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image028.png" alt="img"></p>
<p>Ø Redis解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 在redis中为大V用户设定用户信息，一用户主键和属性值作为key，后台设定定时刷新策略即可</p>
<p>eg: user:id：3506728370：fans  —— 12210947</p>
<p>eg: user id：3506728370：blogs —— 6164</p>
<p>eg: user:id：3506728370：focuss —— 83</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 在 redis中以json格式存储大V用户信息，定时刷新（也可以用hash类型）</p>
<p>##同上区别在于，使用上面方法可以针对某条信息修改，而json则需要全部更新</p>
<p>eg: user:id：3506728370 —— </p>
<p>{id：3506728370，name：春晚，fans：12210862，blogs：6164，focus：83}</p>
<p>##Redis应用于各种结构型和非结构型高热度数据访问加速</p>
<p>l key的设置约定</p>
<p>数据库中的热点数据key命名管理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image030.jpg" alt="img"></p>
<h3 id="2-2-Redis数据类型之hash"><a href="#2-2-Redis数据类型之hash" class="headerlink" title="2-2. Redis数据类型之hash"></a>2-2. Redis数据类型之hash</h3><p>存储的困惑</p>
<p>对象类数据的存储如果具有较频繁的更新操作会显得笨重</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image032.jpg" alt="img"></p>
<p>l hash数据类型：一个key对应多条value数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image034.jpg" alt="img"></p>
<p>Ø 新的存储需求：对一系列存储的数据进行编组，方便管理，典型应用存储对象信息</p>
<p>Ø 需要的存储结构：一个存储空间保存多个键值对数据</p>
<p>Ø hash类型：底层使用哈希表结构实现数据存储</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image036.jpg" alt="img"></p>
<p>Ø hash存储结构优化</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 如果fed数量较少，存储结构优化为类数组结构</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 如果feld数量较多，存储结构使用 HashMap结构</p>
<p>##关于hash表结构可以自行查阅资料</p>
<p>l hash类型数据基本操作</p>
<p>Ø 添加/修改数据</p>
<p><strong>hset</strong> key field value</p>
<p>Ø 获取数据</p>
<p><strong>hget</strong> key field</p>
<p><strong>hgetall</strong> key</p>
<p>Ø 删除数据</p>
<p><strong>hdel</strong> key fieldl [field2]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image037.png" alt="img"></p>
<p>Ø 添加/修改多个数据</p>
<p><strong>hmset</strong> key fieldl valuel field2 value2</p>
<p>Ø 获取多个数据</p>
<p><strong>hmget</strong> key fieldl field2</p>
<p>Ø 获取哈希表中字段的数量</p>
<p><strong>hlen</strong> key</p>
<p>Ø 获取哈希表中是否存在指定的字段</p>
<p><strong>hexists</strong> key field</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image038.png" alt="img"></p>
<p>l hash类型数据扩展操作</p>
<p>Ø 获取哈希表中所有的字段名和字段值</p>
<p><strong>hkeys</strong> key</p>
<p><strong>hvals</strong> key</p>
<p>Ø 设置指定字段的数值数据增加指定范围的值</p>
<p><strong>hincrby</strong> key field increment</p>
<p><strong>hincrbyfloat</strong> key field increment</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image039.png" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image040.png" alt="img"></p>
<p>l hash类型数操作的注意事项</p>
<p>Ø hash类型下的 value只能存储字符串，不允许存储其他数据类型，不存在嵌簊现象。如果数据末获取到，对应的值为（nil）</p>
<p>Ø 每个hash可以存储232-1个键值对</p>
<p>Ø hash类型十分贴近对象的数据存储形式，并且可以灵活添加删除对象属性。但hash设计初衷不是为了存储大量对象而设计的，切记不可滥用，更不可以将hash作为对象列表使用</p>
<p>Ø hgetall操作可以获取全部属性，如果内部feld过多，遍历整体数据效率就很会低，有可能成为数据访问瓶颈</p>
<p>l hash类型应用场景</p>
<p>Ø 业务场景一：电商网站购物车设计与实现</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image042.jpg" alt="img"></p>
<p>Ø 业务分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 仅分析购物车的redis存储模型</p>
<p>添加、浏览、更改数量、删除清空</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 购物车于数据库间持久化同步（不讨论）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 购物车于订单间关系（不讨论）</p>
<p>提交购物车：读取数据生成订单</p>
<p>商家临时价格调整：隶属于订单级别</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 未登录用户购物车信息存储（不讨论）</p>
<p>cookie存储</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 以客户id作为key：每位客户创建—个hash存储结构存储对应的购物车信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将商品编号作为feld：购买数量作为value进行存储</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 添加商品：追加全新的fed与 value</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 浏览：遍历hash</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 更改数量：自增/自减，设置value值</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 删除商品：删除field</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 清空：删除key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image043.png" alt="img"></p>
<p>Ø 思考：当前设计是否真的加速了购物车的呈现</p>
<p>当前仅仅是将数据存儲到了 redist中，并没有起到加速的作用，商品信息还需要二次查询数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 每条购物车中的商品记录保存成两条field </p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> field1专用于保存购买数量</p>
<p>命名格式：商品 id:nums</p>
<p>保存数据：数值</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> field2专用于保存购物车中显示的信息，包含文字描述，图片地址，所属商家信息等</p>
<p>命名格式：商品id:info</p>
<p>保存数据：json</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image044.png" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image046.jpg" alt="img"></p>
<p>##将商品信息的内容独立出来作为一个独立hash，被所有购买相同商品的用户调用即可</p>
<p>Ø <strong>hsetnx</strong> key field value</p>
<p>##如果这个key对用的field中有值，那就什么都不错，否则便将现在的值插进去</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image048.jpg" alt="img"></p>
<p>###############################################################################</p>
<p>Ø 业务场景二</p>
<p>双11活动日，销售手机充值卡的商家对移动、联通、电信的30元、50元、100元商品推出抡购活动，每种商品抢购上限1000张</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image050.jpg" alt="img"></p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 以商家id作为key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将参与抢购的商品id作为 field</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将参与抢购的商品数量作为对应的value</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 抢购时使用降值的方式控制产品数量</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image051.png" alt="img"></p>
<p>##redis应用于抢购、限购、限量发放、激活码等业务的数据存储设计</p>
<p>Ø string存储对象（json）和hash存储对象</p>
<p>string的json格式存储对象将就整体性，数据要不一次更新要不一次获取，更偏向读操作</p>
<p>hash因为有field的存在，所以更新获取都相对比较灵活</p>
<h3 id="2-3-Redis数据类型之list"><a href="#2-3-Redis数据类型之list" class="headerlink" title="2-3. Redis数据类型之list"></a>2-3. Redis数据类型之list</h3><p>数据存储需求：存储多个数据，并对数据进入存储空间的顺序进行区分</p>
<p>需要的存储结构：—个存储空间保存多个数据，且通过数据可以体现进入顺序</p>
<p>list类型：保存多个数据，底层使用双向链表存储结构实现</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image053.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image055.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image057.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image059.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image061.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image063.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image065.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image067.jpg" alt="img"></p>
<p>l list类型数据基本操作</p>
<p>Ø 添加/修改数据</p>
<p><strong>lpush</strong> key value1 [value2]……  ##从左边插入，最后插入保持最前队列</p>
<p><strong>rpush</strong> key value1 [value2]……  ##从右边插入，第一插入保持第一队列</p>
<p>Ø 获取数据</p>
<p><strong>lrange</strong> key start stop //索引查询：0表示首个、-1表示最后一个、-2表示倒数第二个</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image068.png" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image069.png" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image071.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image072.png" alt="img"></p>
<p><strong>lindex</strong> key index </p>
<p><strong>llen</strong> key //查询有多少行数据</p>
<p>Ø 获取并移除数据</p>
<p><strong>lpop</strong> key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image073.png" alt="img"></p>
<p><strong>rpop</strong> key</p>
<p>Ø 规定时间内获取并移除数据</p>
<p><strong>blpop</strong> key1 [key2] timeout</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image075.jpg" alt="img"></p>
<p><strong>brpop</strong> key1 [key2] timeout</p>
<p>#####################################################################</p>
<p>l <strong>list**</strong>数据类型拓展操作**</p>
<p>Ø 微信朋友圈点赞，要求按照点赞顺序显示点赞好友信息，如果取消点赞，移除对应好友信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image077.jpg" alt="img"></p>
<p>Ø 解决方案</p>
<p>移除指定数据</p>
<p><strong>lrem</strong> key count value</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image079.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image080.png" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image082.jpg" alt="img"></p>
<p>##redis应用于具有操作先后顺序的数据控制</p>
<p>l list类型数据操作注意事项</p>
<p>Ø list中保存的数据都是 string类型的，数据总容量是有限的，最多232-1个元素（4294967295）</p>
<p>Ø list具有索引的概念，但是操作数据时通常以队列的形式进行入队出队操作，或以栈的形式进行入栈出栈操作</p>
<p>Ø 获取全部数据操作结束索引设置为-1</p>
<p>Ø list可以对数据进行分页操作，通常第一页的信息来自于list，第2页及更多的信息通过数据库的形式加载</p>
<p>l list类型引用场景</p>
<p>Ø 业务场景</p>
<p>twitter、新浪微博、腾讯微博中个人用户的关注列表需要按照用户的关注顺序进行展示，粉丝列表需要将最近关注的粉丝列在前面</p>
<p>新闻、资讯类网站如何将最新的新闻或资讯按照发生的时间顺序展示？</p>
<p>企业运营过程中，系统将产生出大量的运营数据，如何保障多台服努器操作日志的統一顺序输出？</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image084.jpg" alt="img"></p>
<p>Ø 解决方案</p>
<p>依赖ist的数据具有顺序的特征对信息进行管理使用队列模型解决多路信息汇总合并的问题使用栈模型解决最新消息的问题</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image086.jpg" alt="img"></p>
<h3 id="2-4-Redis数据类型之set"><a href="#2-4-Redis数据类型之set" class="headerlink" title="2-4. Redis数据类型之set"></a>2-4. Redis数据类型之set</h3><p>新的存储需求：存储大量的数据，在查询方面提供更高的效率</p>
<p>需要的存储结构：能够保存大量的数据，高效的内部存儲机制，便于查询</p>
<p>set类型：与hash存储结构完全相同，仅存储键，不存储值（ni），并且值是不允许重复的</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image088.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image090.jpg" alt="img"></p>
<p>l set类型数据的基本操作</p>
<p>Ø 添加数据</p>
<p><strong>sadd</strong> key member1 [member2]</p>
<p>Ø 获取全部数据</p>
<p><strong>smembers</strong> key</p>
<p>Ø 删除数据</p>
<p><strong>srem</strong> key memberI [member2]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image091.png" alt="img"></p>
<p>Ø 获取集合数据总量</p>
<p><strong>scard</strong> key</p>
<p>Ø 判断集合中是否包含指定数据</p>
<p><strong>sismember</strong> key member</p>
<p>l set类型数据的扩展操作</p>
<p>Ø 业务场景</p>
<p>每位用户首次使用今日头条时会设置3项爱好的内容，但是后期为了增加用户的活跃度、兴趣点，必须让用户对其他信息类别逐渐产生兴趣，增加客户留存度，如何实现？</p>
<p>Ø 业务分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 系统分析出各个分类的最新或最热点信息条目并组织成set集合</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 随机挑选其中部分信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 配合用户关注信息分类中的热点信息组织成展示的全信息集合</p>
<p>##自主选择+口味窥探</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 随机获取集合中指定数量的数据</p>
<p><strong>srandmember</strong> key [count]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 随机获取集合中的某个数据并将该数据移出集合</p>
<p><strong>spop</strong> key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image093.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image094.png" alt="img"></p>
<p>##redis应用于随机推荐类信息检索，例如热点歌单推荐，热点新闻推荐，热卖旅游线路，应用APP推荐，大V推荐等</p>
<p>l set数据类型的拓展操作</p>
<p>Ø 业务场景</p>
<p>脉脉为了促进用户间的交流，保障山务成单率的提升，需要让每位用户拥有大量的好友，事实上职场新人不具有更多的职场好友，如何快速为用户积累更多的好友？</p>
<p>新浪微博为了增加用户热度，提高用户留存性，需要微博用户在关注更多的人，以此获得更多的信息或热门话题，如何提高用户关注他人的总量？</p>
<p>QQ新用户入网年龄越来越低，这些用户的朋友圈交际圈非常小，往往集中在一所学校甚至一个班级中，如何帮助用户快速积累好友用户带来更多的活跃度？</p>
<p>微信公众号是微信信息流通的渠道之一，增加用户关注的公众号成为提高用户活跃度的_种方式，如何帮助用户积累更多关注的公众号？</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 求两个集合的交、并、差集</p>
<p><strong>sinter</strong> keyl [key2]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image096.jpg" alt="img"></p>
<p><strong>sunion</strong> keyl [key2]</p>
<p><strong>sdiff</strong> keyl [key2]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image097.png" alt="img"></p>
<p>##sdiff的两个key的顺序很重要，得到的结果是被减者中没有的数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 求两个集合的交、并、差集并存储到指定集合中</p>
<p><strong>interstore</strong> destination keyl [key2]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image098.png" alt="img"></p>
<p><strong>sunions</strong> tore destination keyl [key2]</p>
<p><strong>sdiffstore</strong> destination keyl [key2]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将指定数据从原始集合中移动到目标集合中</p>
<p><strong>smove</strong> source destination member</p>
<p>##redis应用于同类信息的关联搜索，一度关联搜索，深度关联搜索</p>
<p>##显示共同关注（一度）</p>
<p>##显示共同好友（一度）</p>
<p>##由用户A出发，获取到好友用户B的好友信息列表（一度）</p>
<p>##由用户A出发，获取至好友用户B的购物清单列表（二度）</p>
<p>##由用户A出发，获取到好友用户B的游戏充值列表（二度）</p>
<p>l set数据类型操作的注意事项</p>
<p>Ø set类型不允许数据重复，如果添加的数据在set中已经存在，将只保留一份</p>
<p>Ø set虽然与hash的存储结构相同，但是无法启用hash中存储值的空间</p>
<p>l set类型应用场景</p>
<p>Ø 业务场景</p>
<p>集团公司共具有12000名员工，内部OA系统中具有700多个角色，3000多个业务操作，23000多种数据，每位员工具有一个或多个角色，如何快速进行业务操作的权限校验？</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image100.jpg" alt="img"></p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 依赖set集合数据不重复的特征，依赖set集合hash存储结构特征完成数据过滤与快</p>
<p>查询</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 根据用户id获取用户所有角色</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 根据用户所有角色获取用户所有操作权限放入set集合</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 根据用户所有角色获取用户所有数据全选放入set集合</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image102.jpg" alt="img"></p>
<p>Ø 思考：redis究竟是提供基础数据还是校验结果？</p>
<p>推荐：redis作为提供基础数据即可，与业务分离，进行解耦合</p>
<p>##redis可以应用于同类不重复数据的合并操作</p>
<p>l set类型应用场景</p>
<p>Ø 业务场景一：</p>
<p>公司对旗下新的网站做推广，统计网站的PV（访问量），UV（独立访客），IP（独立IP）。</p>
<p>PV：网站被访问次数，可通过刷新页面提高访问量</p>
<p>UV：网站被不同用户访问的次数，可通过 cookie统计访问量，相同用户切换IP地址，UV不变</p>
<p>IP：网站被不同IP地址访问的总次数，可通过IP地址统计访问量，相同IP不同用户访问，IP不变</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 利用set集合的数据去重特征，记录各种访问数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 建立 string类型数据，利用incr统计日访问量（PV）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 建立set模型，记录不同 cookie数量（UV）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 建立set模型，记录不同IP数量（IP）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image103.png" alt="img"></p>
<p>Ø 业务场景二：</p>
<p>黑名单资讯类信息类网站迫求高访问量，但是由于其信息的价值，往往容易被不法分子利用，通过爬虫技术，快速获取信息，个别特种行业网站信息通过爬虫获取分析后，可以转换成商业机密进行出售。例如第三方火车票、机票、酒店刷票代购软件，电商刷评论、刷好评</p>
<p>同时爬虫带来的伪流量也会给经营者带来错觉，产生错误的决策，有效避免网站被爬虫反复爬取成为每个网站都要考虑的基本问题。在基于技术层面区分出爬虫用户后，需要将此类用户进行有效的屏蔽，这就是黑名单的典型应用</p>
<p>ps不是说爬虫一定做摧毁性的工作，有些小型网站需要爬虫为其带来一些流量。</p>
<p>白名单对于安全性更高的应用访问，仅仅靠黑名单是不能解决安全问题的，此时需要设定可访问的用户群体，依赖白名单做更为苛刻的访问验证。</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 基于经营战略设定问题用户发现、鉴别规则</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 周期性更新满足规则的用户黑名单，加入set集合</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 用户行为信息达到后与黑名单进行比对，确认行为去向</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 黑名单过滤P地址：应用于开放游客访问权限的信息源</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 黑名单过滤设备信息：应用于限定访可设备的信息源</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 黑名单过滤用户：应用于基于访问权限的信息源</p>
<p>##redis应用于基于黑名单与白名单设定的服务控制</p>
<h3 id="2-5-Redis数据类型之sorted-set"><a href="#2-5-Redis数据类型之sorted-set" class="headerlink" title="2-5. Redis数据类型之sorted_set"></a>2-5. Redis数据类型之sorted_set</h3><p>l 新的存储需求：数据排序有利于数据的有效展示，需要提供种可以根据自身特征进行排序的方式</p>
<p>l 需要的存储结构：新的存储横型，可以保存可排序的数据</p>
<p>l sorted set类型：在set的存储结构基础上添加可排序字段</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image105.jpg" alt="img"></p>
<p>l sorted_set类型数据基本操作</p>
<p>Ø 添加数据</p>
<p><strong>zadd</strong> key scorel member [score2 member2]</p>
<p>Ø 获取全部数据</p>
<p><strong>zrange</strong> key start stop [WITHSCORES]</p>
<p><strong>zrevrange</strong> key start stop [WITHSCORES]</p>
<p>Ø 删除数据</p>
<p><strong>zrem</strong> key member [member…]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image107.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image109.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image110.png" alt="img"></p>
<p>Ø 按条件获取数据</p>
<p><strong>zrangebyscore</strong> key min max [WITHSCORES] [LIMIT]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image112.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image114.jpg" alt="img"></p>
<p><strong>zrevrangebyscore</strong> key max min [WITHSCORES]</p>
<p>Ø 条件删除数据</p>
<p><strong>zremrangebyrank</strong> key start stop </p>
<p><strong>zremrangebyscore</strong> key min max</p>
<p>Ø 注意</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> min与max用于限定搜索查询的条件</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> statt与stop用于限定查询范围，作用于索引，表示开始和结束索引</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> offset与 count用于限定查询范围，作用于查询结果，表示开始位置和数据总量</p>
<p>Ø 获取集合数据总量</p>
<p><strong>card</strong> key zcount key min max</p>
<p>Ø 集合交、并操作</p>
<p><strong>zinterstore</strong> destination numkeys key [key…]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image115.png" alt="img"></p>
<p><strong>zunionstore</strong> destination numkeys key [key…]</p>
<p>l sorted_set类型数据的扩展操作</p>
<p>Ø 业务场景</p>
<p>票选广东十大杰出青年，各类宗艺选秀海选投票各类资源网站IOP10（电影，歌曲，文档，电商，游戏等）、聊天室活跃度统计游戏好友亲密度</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 获取数据对应的索引（排名）</p>
<p>zrank key member zrevrank key member score</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 值获取与修改</p>
<p>zscore key member zincrby key increment member</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image116.png" alt="img"></p>
<p>##redis可以应用于计数器组合排序功能对应的排名</p>
<p>l sorted_set数据类型操作的注意事项</p>
<p>Ø score保存的数据存储空间是64位，如果是整数范围是</p>
<p>900719254740992~9007199254740992</p>
<p>Ø score保存的数据也可以是一个双精度的 double值，基于双精度浮点数的特征，可能会丢失精度，使用时候要慎重</p>
<p>Ø sorted set底层存储还是基于set结构的，因此数据不能重复，如果重复添加相同的数据， score值将被反复覆盖，保留最后一次修改的结果</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image117.png" alt="img"></p>
<p>l sorted_set类型应用场景</p>
<p>Ø 业务场景一：</p>
<p>基础服务+增值服务类网站会设定各位会员的试用，让用户充分体验会员优势。例如观影试用VIP、游戏VIP体验、云盘下载体验VIP、数据查看体验VIP。当VIP体验到眀后，如果有效管理此类信息。即便对于正式VIP用户也存在对应的管理方式。</p>
<p>网站会定期开启投票、讨论，限时进行，逾期作废。如何有效管理此类过期信息</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 对于基于时间线限定的任务处理，将处理时间记录为 score值，利用排序功能区分处理的先后顺序</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 记录下一个要处理的时间，当到期后处理对应任务，移除 redis中的记录，并记录下一个要处理的时间</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 当新任务加入时，判定并更新当前下一个要处理的任务时间</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 为提升 sorted set的性能，通常将任务根据特征存储成若干个 sorted set。例如1时内，1天内，周内，月内，季内，年度等，操作时逐级提升，将即将操作的若干个任务纳入到1小时内处理的队列中</p>
<p>Ø  redist获取当前系统时间</p>
<p>time</p>
<p>##redis可以应用于定时任务执行顺序管理或任务过期管理</p>
<p>Ø 业务场景二：</p>
<p>任务/消息权重设定应用</p>
<p>当任务或者消息待处理，形成了任务队列或消息队列时，对于高优先级的任务要保障对其优先处理，如何实现任务权重管理</p>
<p>Ø 解决方案</p>
<p>对于带有权重的任务，优先处理权重高的任务，采用score记录权重即可</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image118.png" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image119.png" alt="img"></p>
<p>#####################################################################</p>
<p>Ø 业务场景三：多条件任务权重设定</p>
<p>如果权重条件过多时，需要对排序 score值进行处理，保障 score值能够兼容2条件或者多条件，例如外贸订单优先于国内订单，总裁订单优先于员工订单，经理订单优先于员工订单</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 因 score长度受限，需要对数据进行截断处理，尤其是时间设置为小时或分钟级即可（折算后）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 先设定订单类别，后设定订单发起角色类别，整体 score长度必须是统的，不足位补0.第一排序规则首位不得是0</p>
<p>例如外贸101，国内102，经理004，员工008</p>
<p>员工下的外贸单sore值为101008（优先）</p>
<p>经理下的国内单 score值为102004</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image120.png" alt="img"></p>
<p>##zadd（指令）、tt（key）、101008（score#死购er）、order#订单:id:2（value）</p>
<h3 id="2-6-Redis数据类型综合实践案例"><a href="#2-6-Redis数据类型综合实践案例" class="headerlink" title="2-6. Redis数据类型综合实践案例"></a>2-6. Redis数据类型综合实践案例</h3><p>l 实践案例</p>
<p>人工智能领域的语义识别与自动对话将是未来服务业机器人应答呼叫体系中的重要技术，百度自研用户评价语义识别服务，免费开放给企业试用，同时训练百度自己的模型。现对试用用户的使用行为进行限速，限制每个用户每分钟最多发起10次调用</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设计计数器，记录调用次数，用于控制业务执行次数。以用户作为key，使用次数作为vaue</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 在调用前获取次数，判断是否超过限定次数</p>
<p>不超过次数的情况下，每次调用计数+1</p>
<p>业务调用失败，计数-1</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 为计数器设置生命周期为指定周期，例如1秒分钟，自动清空周期内使用次数</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image122.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image124.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image126.jpg" alt="img"></p>
<p>Ø 解决方案改良</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 取消最大值的判定，利用incr操作超过最大值抛出异常的形式替代每次判断是否大于最大值</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 判断是否为nil</p>
<p>如果是，设置为Max-次数</p>
<p>如果不是，计数+1</p>
<p>业务调用失败，计数-1</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 遇到异常即+操作超过上限，视为使用达到上限</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image128.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image129.png" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image130.png" alt="img"></p>
<p>##Redis可以应用于限时按次计算的服务控制</p>
<p>l 业务场景</p>
<p>使用微信的过程中，当微信接收消息后，会默认将最近接收的消息置顶，当多个好友及关注的订阅号同时发送消息时，该排序会不停的进行交替。同时还可以将重要的会话设置为置顶。一旦用户离线后，再次打开微信时，消息该按照什么样的顺序显示？</p>
<p>Ø 业务分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image132.jpg" alt="img"></p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 依赖list的数据具有顺序的特征对消息进行管理，将ist结构作为栈使用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 对置顶与普通会话分别创建独立的list分别管理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 当某个list中接收到用户消息后，将消息发送方的id从list的一侧加入list（此处设定左侧）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 多个相同id发出的消息反复入栈会出现问题，在入栈之前无论是否具有当前id对应的消息，先删除对应id</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 推送消息时先推送置顶会话list，再推送普通会话list，推送完成的list清除所有数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 消息的数量，也就是微信用户对话数量采用计数器的思想另行记录，伴随list操作同步更新</p>
<p>##Redis可以应用于时间顺的数据操作，而不关注具体时间</p>
<p>l redis解决方案列表</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image134.jpg" alt="img"></p>
<h2 id="第三节：Redis通用命令"><a href="#第三节：Redis通用命令" class="headerlink" title="第三节：Redis通用命令"></a>第三节：Redis通用命令</h2><h3 id="3-1-Redis通用命令之key通用操作"><a href="#3-1-Redis通用命令之key通用操作" class="headerlink" title="3-1. Redis通用命令之key通用操作"></a>3-1. Redis通用命令之key通用操作</h3><p>l key特征</p>
<p>key是一个字符串，通过key获取redis中保存的数据</p>
<p>Ø 对于key自身状态的相关操作，例如：删除，判定存在，获取类型等</p>
<p>Ø 对于key有效性控制相关操作，例如：有效期设定，判定是否有效，有效状态的切换等</p>
<p>Ø 对于key快速查询操作，例如：按指定策略查询key</p>
<p>l key基本操作</p>
<p>Ø 删除指定：<strong>key</strong> del key</p>
<p>Ø 获取key是否存在：<strong>exists</strong> key</p>
<p>Ø 获取key的类型：<strong>type</strong> key</p>
<p>l key扩展操作（时效性控制）</p>
<p>Ø 为指定key设置有效期</p>
<p>expire key seconds </p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image135.png" alt="img"></p>
<p>pexpire key milliseconds （毫秒级）</p>
<p>expireat key timestamp </p>
<p>pexpireat key milliseconds-timestamp</p>
<p>Ø 获取key的有效时间</p>
<p>ttl key </p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image136.png" alt="img"></p>
<p>pttl key</p>
<p>Ø 切换key从时效性转换为永久性</p>
<p>persist key</p>
<p>l key扩展操作（查询模式）</p>
<p>Ø 查询key：keys pattern</p>
<p>Ø 查询模式规则</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> *  匹配任意数量的任意字符</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> ？  配合一个任意符号</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> []  匹配一个指定符号</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image138.jpg" alt="img"></p>
<p>l key的其他操作</p>
<p>Ø 为key改名</p>
<p>rename key newkey </p>
<p>renamenx key newkey</p>
<p>Ø 对所有key排序</p>
<p>sort</p>
<p>Ø 其他key通用操作</p>
<p>help @generic</p>
<h3 id="3-2-Redis通用命令之DB通用操作"><a href="#3-2-Redis通用命令之DB通用操作" class="headerlink" title="3-2. Redis通用命令之DB通用操作"></a>3-2. Redis通用命令之DB通用操作</h3><p>l Redis数据库</p>
<p>Ø key的重复问题</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> key是由程序员定义的</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> redis在使用过程中，伴随着操作数据量的增加，会出现大量的数据以及对应的key</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据不区分种类、类别混杂在起，极易出现重复或冲突</p>
<p>Ø 解决方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> redis为每个服务提供有16个数据库，编号从0到15</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 每个数据库之间的数据相互独立</p>
<p>l 数据库基本操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 切换数据库</p>
<p>select index</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 其他操作</p>
<p>quit </p>
<p>ping</p>
<p>echo message</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据移动</p>
<p>move key dib</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据清除</p>
<p>dbsize   ##查看库中有多少key</p>
<p>flushdb  ##清除当前库内容</p>
<p>flushall  ##清除所有库内容</p>
<h2 id="第四节：Redis与java连接工具jedis"><a href="#第四节：Redis与java连接工具jedis" class="headerlink" title="第四节：Redis与java连接工具jedis"></a>第四节：Redis与java连接工具jedis</h2><p>java语言连接redis服务方法：jedis、SpringData Redis、Lettuce</p>
<h3 id="4-1-Jedis基本使用"><a href="#4-1-Jedis基本使用" class="headerlink" title="4-1. Jedis基本使用"></a>4-1. Jedis基本使用</h3><p>l 准备工作</p>
<p>Ø jar包导入</p>
<p>下载地址：<a href="https://mvnrepository.com/artifact/redis.clients/jiedis" target="_blank" rel="noopener">https://mvnrepository.com/artifact/redis.clients/jiedis</a></p>
<p>Ø 基于maven</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image140.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image142.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image144.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image146.jpg" alt="img"></p>
<p>l 使用jedis连接redis</p>
<p>连接redis</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image148.jpg" alt="img"></p>
<p>操作redis</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image150.jpg" alt="img"></p>
<p>关闭redis连接</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image152.jpg" alt="img"></p>
<h3 id="4-2-Jedis读写Redis数据"><a href="#4-2-Jedis读写Redis数据" class="headerlink" title="4-2. Jedis读写Redis数据"></a>4-2. Jedis读写Redis数据</h3><p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image154.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image156.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image158.jpg" alt="img"></p>
<p>#####################################################################</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image160.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image162.jpg" alt="img"></p>
<p>l 使用jedis实现案例：服务调用次数控制</p>
<p>人工智能领域的语义识别与自动对话将是未来服务业机器人应答呼叫体系中的重要技术，百度自硏用户评价语义识别服务，免费开放给企业试用，同时训练百度自己的模型。现对试用用户的使用行为进行限速限制每个用户每分钟最多发起10次调用</p>
<p>Ø 案例要求</p>
<p>设定A、B、C三个用户</p>
<p>A用户限制10次/分调用，B用户限制30次/分调用，C用户不限制</p>
<p>Ø 需求分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设定一个服务方法，用于模拟实际业务调用的服务，内部釆用打印横拟调用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 在业务调用前服务调用控制单元，内部使用 redis进行控制，参照之前的方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 对调用超限使用异常进行控制，异常处理设定为打印提示信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 主程序启动3个线程，分别表示3种不同用户的调用</p>
<p>Ø 功能实现</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> jedis相关配置</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image164.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 创建相关项目</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image166.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image168.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image170.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image172.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image174.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image176.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image178.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image180.jpg" alt="img"></p>
<p>Ø 实现步骤</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设定业务方法</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image182.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设定多线程，模拟用户调用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image184.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设计redis控制方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image186.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 设计启动主程序</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image187.png" alt="img"></p>
<p>后续1：对业务控制方案进行改造，设定不同用户等级的判定</p>
<p>后续2：将不同用户等级对应的信息、限制次数等设定到 redis中，使用hash保存</p>
<h1 id="第二部分：Redis高级"><a href="#第二部分：Redis高级" class="headerlink" title="第二部分：Redis高级"></a>第二部分：Redis高级</h1><h2 id="第一节：Linux环境部署Redis服务"><a href="#第一节：Linux环境部署Redis服务" class="headerlink" title="第一节：Linux环境部署Redis服务"></a>第一节：Linux环境部署Redis服务</h2><p>l Linxu部署Redis</p>
<p>Ø 下载并解压redis</p>
<p>tar –vxf redis-5.0.8</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image189.jpg" alt="img"></p>
<p>Ø 安装文件Makefile信息</p>
<p>[root@goaccess redis-5.0.8]# cat Makefile </p>
<p># Top level makefile, the real shit is at src/Makefile</p>
<p>default: all</p>
<p>.DEFAULT:</p>
<p>​    cd src &amp;&amp; $(MAKE) $@</p>
<p>install:</p>
<p>​    cd src &amp;&amp; $(MAKE) $@</p>
<p>.PHONY: install</p>
<p>Ø 编译安装redis</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 安装gcc相关依赖</p>
<p>yum -y install cpp binutils glibc glibc-kernheaders glibc-common glibc-devel gcc make</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 编译安装redis</p>
<p>make install</p>
<p>##关于编译安装的一次报错记录</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image191.jpg" alt="img"></p>
<p>解决方法：make MALLOC=libc </p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 启动redis</p>
<p>执行src/redis-server</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image193.jpg" alt="img"></p>
<p>Ø 修改redis启动端口</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 启动redis</p>
<p>[root@goaccess src]# redis-server –port 6380（自定义端口）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image195.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 访问redis</p>
<p>[root@goaccess src]# redis-cli -p 6380</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image197.jpg" alt="img"></p>
<p>Ø 使用redis配置文件启动</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 筛选并重定向一份新的conf文件</p>
<p>cat redis.conf | grep -v “#” | grep -v “^$” &gt; redis-6379.conf</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 配置文件简阅</p>
<p>bind 127.0.0.1 ##绑定网卡</p>
<p>protected-mode yes</p>
<p>port 6379</p>
<p>tcp-backlog 511</p>
<p>timeout 0</p>
<p>tcp-keepalive 300</p>
<p>daemonize no  ##是否以守护进程启动</p>
<p>supervised no</p>
<p>pidfile /var/run/redis_6379.pid</p>
<p>loglevel notice</p>
<p>logfile “”  ##日志文件名称</p>
<p>databases 16</p>
<p>always-show-logo yes</p>
<p>save 900 1</p>
<p>save 300 10</p>
<p>save 60 10000</p>
<p>stop-writes-on-bgsave-error yes</p>
<p>rdbcompression yes</p>
<p>rdbchecksum yes</p>
<p>dbfilename dump.rdb</p>
<p>dir ./  ##日志文件存放位置</p>
<p>replica-serve-stale-data yes</p>
<p>replica-read-only yes</p>
<p>repl-diskless-sync no</p>
<p>repl-diskless-sync-delay 5</p>
<p>repl-disable-tcp-nodelay no</p>
<p>replica-priority 100</p>
<p>lazyfree-lazy-eviction no</p>
<p>lazyfree-lazy-expire no</p>
<p>lazyfree-lazy-server-del no</p>
<p>replica-lazy-flush no</p>
<p>appendonly no</p>
<p>appendfilename “appendonly.aof”</p>
<p>appendfsync everysec</p>
<p>no-appendfsync-on-rewrite no</p>
<p>auto-aof-rewrite-percentage 100</p>
<p>auto-aof-rewrite-min-size 64mb</p>
<p>aof-load-truncated yes</p>
<p>aof-use-rdb-preamble yes</p>
<p>lua-time-limit 5000</p>
<p>slowlog-log-slower-than 10000</p>
<p>slowlog-max-len 128</p>
<p>latency-monitor-threshold 0</p>
<p>notify-keyspace-events “”</p>
<p>hash-max-ziplist-entries 512</p>
<p>hash-max-ziplist-value 64</p>
<p>list-max-ziplist-size -2</p>
<p>list-compress-depth 0</p>
<p>set-max-intset-entries 512</p>
<p>zset-max-ziplist-entries 128</p>
<p>zset-max-ziplist-value 64</p>
<p>hll-sparse-max-bytes 3000</p>
<p>stream-node-max-bytes 4096</p>
<p>stream-node-max-entries 100</p>
<p>activerehashing yes</p>
<p>client-output-buffer-limit normal 0 0 0</p>
<p>client-output-buffer-limit replica 256mb 64mb 60</p>
<p>client-output-buffer-limit pubsub 32mb 8mb 60</p>
<p>hz 10</p>
<p>dynamic-hz yes</p>
<p>aof-rewrite-incremental-fsync yes</p>
<p>rdb-save-incremental-fsync yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 修改基本配置项</p>
<p>port 6379</p>
<p>daemonize yes  ##是否以守护进程启动</p>
<p>logfile “6379.log”  ##日志文件名称</p>
<p>dir /usr/local/redis/log（手工创建）  ##日志文件存放位置</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image199.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 以配置文件方式启动redis</p>
<p>redis-server redis-6379.conf</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image201.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image203.jpg" alt="img"></p>
<p>Ø 配置文件启动目录管理</p>
<p>先将旧的服务关闭</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image205.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image207.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image209.jpg" alt="img"></p>
<p>##redis配置文件参考文章：</p>
<p><a href="https://blog.csdn.net/suprezheng/article/details/90679790" target="_blank" rel="noopener">https://blog.csdn.net/suprezheng/article/details/90679790</a></p>
<p><a href="https://www.cnblogs.com/ysocean/p/9074787.html" target="_blank" rel="noopener">https://www.cnblogs.com/ysocean/p/9074787.html</a></p>
<h2 id="第二节：Redis持久化"><a href="#第二节：Redis持久化" class="headerlink" title="第二节：Redis持久化"></a>第二节：Redis持久化</h2><p>l 什么是持久化</p>
<p>利用永久性存储介质将数据进行保存，在特定的时间将保存的数据进行恢复的工作机制称为持久化。</p>
<p>l 为什么要进行持久化</p>
<p>防止数据的意外丢失，确保数据安全性</p>
<p>l 持久化实现方式</p>
<p>Ø 将当前数据状态进行保存，快照形式，存储数据结果，存储格式简单，关注点在数据（RDB）</p>
<p>Ø 将数据的操作过程进行保存，日志形式，存储操作过程，存储格式复杂，关注点在数据的操作过程（AOF）</p>
<h3 id="2-1-Redis持久化方案一：RDB"><a href="#2-1-Redis持久化方案一：RDB" class="headerlink" title="2-1. Redis持久化方案一：RDB"></a>2-1. Redis持久化方案一：RDB</h3><p>l RDB启动方式——save指令</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image211.jpg" alt="img"></p>
<p>Ø 命令：save</p>
<p>Ø 作用：手动执行一次保存操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image213.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image215.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image217.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image219.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image221.jpg" alt="img">##再次生成了dump.rdb文件</p>
<p>l RDP启动方式——save指令相关配置</p>
<p>Ø dbfilename dump rdb</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 说明：设置本地数据库文件名，默认值为 dump. rdb</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 经验：通常设置为dump端口.rdb</p>
<p>Ø dir</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 说明：设置存储rdb文件的路径</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 经验：通常设置成存储空间较大的目录中，目录名称data </p>
<p>Ø rdbcompression yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 说明：设置存储至本地数据库时是否压缩数据，默认为yes，采用LZF压缩</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 经验：通常默认为开启状态，如果设置为no，可以节省CPU运行时间，但会使存储的文件变大（巨大）</p>
<p>Ø rdbchecksum yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 说明：设置是否进行RDB文件格式校验，该校验过程在写文件和读文件过程均进行</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 经验：通常默认为开启状态，如果设置为no，可以节约读写性过程约10%时间消肖耗，但是存储定的数据损坏风险</p>
<p>vim /usr/local/redis/conf/redis-6379.conf</p>
<p>port 6379</p>
<p>daemonize yes</p>
<p>logfile “6379.log”</p>
<p>dir /usr/local/redis/log</p>
<p>dbfilename dump-6379.rdb</p>
<p>rdbcompression yes</p>
<p>rddchecksum yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image223.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image225.jpg" alt="img"></p>
<p>l RDB数据恢复</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image227.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image229.jpg" alt="img"></p>
<p>l RDB启动方式——save指令工作原理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image231.jpg" alt="img"></p>
<p>##save指令的执行会阻塞当前Reds服务器，直到当前RDB过程完成为止，有可能会造成长时间阻塞，线上环境不建议使用。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image233.jpg" alt="img"></p>
<p>Ø 命令：bgsave</p>
<p>Ø 作用：手动启动后台保存操作，但不是立即执行</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image235.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image237.jpg" alt="img"></p>
<p>l RDB启动方式——bgsave指令工作原理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image239.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image241.jpg" alt="img"></p>
<p>## bgrave命令是针对save阻塞问题做的优化Red内部所有涉及到RDB操作都采用 bgsave的方式，save命令可以放弃使用</p>
<p>l RDB启动方式——bgsave指令相关配置</p>
<p>Ø stop-writes-on-bgsave-error yes</p>
<p>说明：后台存储过程中如果出现错误现象，是否停止保存操作</p>
<p>经验：通常默认为开启状态</p>
<p>l RDB启动方式——自动执行</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image243.jpg" alt="img"></p>
<p>Ø 配置：<strong>save</strong> second changes</p>
<p>Ø 作用：满足限定时间范围内key的变化数量达到指定数值即进行持久化</p>
<p>Ø 参数：</p>
<p>second：监控时间范围</p>
<p>changes：监控key变化量</p>
<p>Ø 范例：</p>
<p>save 900 1</p>
<p>save 300 10</p>
<p>save 60 10000</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image245.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image247.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image249.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image251.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image253.jpg" alt="img"></p>
<p>##此时已经产生了持久化文件，再次执行两次set观察rdb文件变化</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image255.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image257.jpg" alt="img"></p>
<p>l RDB启动方式——save配置原理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image259.jpg" alt="img"></p>
<p>## save配置要根据实际业努情况进行设置，频度过高或过低都会出现性能问题，结果可能是灾难性的。save配置中对于 second与 hanges设置通常具有互补对应关系，尽量不要设置成包含性关系save配置启动后执行的是 bgsave操作</p>
<p>l RDB三种启动方式对比</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image261.jpg" alt="img"></p>
<p>l RDB特殊启动方式</p>
<p>Ø 全量复制：在主从复制中详解</p>
<p>Ø 服务运行过程中重启：debug reload</p>
<p>Ø 关闭服务时指定保存数据：shutdown save</p>
<p>l RDB优缺点</p>
<p>Ø 优点</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> RDB是一个紧凑压缩的二进制文件，存储效率较高</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> RDB内部存储的是 redis在某个时间点的数据快照，非常适合用于数据备份，全量复制等场景</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> RDB恢复数据的速度要比AOF快很多</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 应用：服务器中每X小时执行 bgsave备份，并将RDB文件拷贝到远程机器中，用于灾难恢复。</p>
<p>Ø 缺点</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> RDB方式无论是执行指令还是利用配置，无法做到实时持久化，具有较大的可能性丢失数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> bgsave指令每次运行要执行fork操作创健子进程，要牺牲掉一些性能</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> Redis的众多版本中未进行RDB文件格式的版本统一，有可能出现各版本服务之间数据格式无法兼容现象</p>
<h3 id="2-2-Redis持久化方案二：AOF"><a href="#2-2-Redis持久化方案二：AOF" class="headerlink" title="2-2. Redis持久化方案二：AOF"></a>2-2. Redis持久化方案二：AOF</h3><p>l RDB存储的弊端</p>
<p>Ø 存储数据量较大，效率较低</p>
<p>基于快照思想，每次读写都是全部数据，当数据量巨大时，效率非常低</p>
<p>Ø 大数据量下的IO性能较低</p>
<p>Ø 基于fork创建子进程，内存产生额外耗</p>
<p>Ø 宕机带来的数据丢失风险</p>
<p>l 解决思路</p>
<p>Ø 不写全数据，仅记录部分数据</p>
<p>Ø 改记录数据为记录操作过程</p>
<p>Ø 对所有操作均进行记录，排除丢失数据的冈险</p>
<p>l AOF概念</p>
<p>Ø AOF（ append only file持久化：以独立日志的方式记录每次写命令，重启时再重新执行AOF文件中命令达到恢复数据的目的。与RDB相比可以简单描述为改记录数据为记录数据产生的过程</p>
<p>Ø AOF的主要作用是解决了数据持久化的实时性，目前已经是Reds持久化的主流方式</p>
<p>l AOF写数据过程</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image263.jpg" alt="img"></p>
<p>Ø AOF写数据三种策略</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> always（每次）</p>
<p>每次写入操作均同步到AOF文件中，数据零误差，性能较低</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> everysec（每秒）（推荐使用、默认配置）</p>
<p>每秒将缓冲区中的指令同步到AOF文件中，数据隹确性较高，性能较高</p>
<p>在系统突然宕机的情况下丢失1秒内的数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> no（系统控制）</p>
<p>由操作系统控制每次同步到AOF文件的周期，整体过程不可控</p>
<p>l AOF功能开启</p>
<p>Ø 配置：<strong>appendonly</strong> yes|no</p>
<p>Ø 作用：是佛开启AOF持久化功能，默认为不开启状态</p>
<p>Ø 配置：<strong>appendfsync</strong> always|everysec|no</p>
<p>Ø 作用：AOF写数据策略</p>
<p>Ø always示例：</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image265.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image267.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image269.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image271.jpg" alt="img"></p>
<p>##get指令不被AOF文件记录，因为没有改变key操作</p>
<p>Ø everysec示例：</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image273.jpg" alt="img"></p>
<p>l AOF相关配置</p>
<p>Ø 配置：appendfilename filename</p>
<p>Ø 作用：AOF持久化文件自定义命名</p>
<p>Ø 配置：dir</p>
<p>Ø 作用：AOF持久化文件保存位置</p>
<h3 id="2-3-Redis持久化AOF：AOF重写"><a href="#2-3-Redis持久化AOF：AOF重写" class="headerlink" title="2-3. Redis持久化AOF：AOF重写"></a>2-3. Redis持久化AOF：AOF重写</h3><p>l AOF写数据时遇到的问题</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image275.jpg" alt="img"></p>
<p>l AOF重写</p>
<p>随着命令不断写入AOF，文件会越来越大，为了解决这个问题，Reds引入了AOF重写机制压缩文件体积。AOF文件重写是将 Redis进程内的数据转化为写命令同步到新AOF文件的过程。简单说就是将对同个数据的若干个条命令执行结果转化成最终结果数据对应的指令进行记录</p>
<p>l AOF重写作用</p>
<p>Ø 降低磁盘占用量，提高磁盘利用率</p>
<p>Ø 提高持久化效率，降低持久化写时间，提高IO性能</p>
<p>Ø 降低数据恢复用时，提高数据恢复效率</p>
<p>l AOF重写规则</p>
<p>Ø 进程内已超时的数据不再写入文件</p>
<p>Ø 忽略无效指令，重写时使用进程内数据直接生成，这样新的AOF文件只保留最终数据的写入命令</p>
<p>如 del key1、 hdel key2、 srem key3、 set key4111、 set key4222等</p>
<p>Ø 对同一数据的多条写命令合并为一条命令</p>
<p>如 Push list1a、 Push list1b、 Push list1c可以转化为：push list1abc为防止数据量过大造成客户端爱冲区溢出，对ist、set、hash、zset等类型，每条指令最多写入64个元素</p>
<p>l AOF重写方式</p>
<p>Ø 手动重写</p>
<p>bgrewriteaof</p>
<p>Ø 自动重写</p>
<p><strong>auto-aof-rewrite-min-size</strong> size </p>
<p><strong>auto-aof-rewrite-percentage</strong> percentage</p>
<p>l AOF手动重写示例</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image277.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image279.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image281.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image283.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image285.jpg" alt="img"></p>
<p>AOF重写前</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image281.jpg" alt="img"></p>
<p>AOF重写后</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image287.jpg" alt="img"></p>
<p>l AOF手动重写——bgrewriteaof指令工作原理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image289.jpg" alt="img"></p>
<p>l AOF自动重写</p>
<p>Ø 自动重写触发条件设置</p>
<p>auto-aof-rewrite-min-size size ##最小触发条件大小 </p>
<p>auto-aof-rewrite-percentage percent ##最小触发条件百分比</p>
<p>Ø 自动重写重复啊比对参数（运行指令info Persistence获取具体参数）</p>
<p>aof_current_size</p>
<p>aof_base_size</p>
<p>Ø 自动重写触发条件</p>
<p>aof_current_size &gt; auto-aof-rewrite-min-size ##当前大小&gt;配置的最小触发值</p>
<p>aof_current_size-aof_base_size（中间是减号）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image290.png" alt="img">              &gt;= auto-aof-rewrite-percentage</p>
<p>​    aof_base_size</p>
<p>AOF自动重写参考文章：</p>
<p><a href="https://www.cnblogs.com/fanBlog/p/9707422.html" target="_blank" rel="noopener">https://www.cnblogs.com/fanBlog/p/9707422.html</a></p>
<p><a href="https://blog.csdn.net/andy86869/article/details/89005638" target="_blank" rel="noopener">https://blog.csdn.net/andy86869/article/details/89005638</a></p>
<p><a href="https://blog.csdn.net/yzj5208/article/details/82083549" target="_blank" rel="noopener">https://blog.csdn.net/yzj5208/article/details/82083549</a></p>
<p>l AOF重写工作原理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image292.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image294.jpg" alt="img"></p>
<h3 id="2-4-Redis持久化RDB与AOF区别"><a href="#2-4-Redis持久化RDB与AOF区别" class="headerlink" title="2-4. Redis持久化RDB与AOF区别"></a>2-4. Redis持久化RDB与AOF区别</h3><p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image296.jpg" alt="img"></p>
<p>l RDB与AOF使用选择</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image298.jpg" alt="img"></p>
<p>l Redis持久化应用场景</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image300.jpg" alt="img"></p>
<h2 id="第三节：Redis事务"><a href="#第三节：Redis事务" class="headerlink" title="第三节：Redis事务"></a>第三节：Redis事务</h2><p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image302.jpg" alt="img"></p>
<p>l 什么是事务</p>
<p>Redis执行指令过程中，多条连续执行的指令被干扰，打断，插队</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image304.jpg" alt="img"></p>
<p>redis事务就是一个命令执行的队列，将一系列预定义命令包装成一个整体（一个队列）。当执行时，一次性按照添加顺序依次执行，中间不会被打断或者千扰。</p>
<p>##一个队列中，一次性、顺序性、排他性的执行系列命令</p>
<p>l 事务基本操作</p>
<p>Ø 事务边界</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image306.jpg" alt="img"></p>
<p>l 事务基本操作</p>
<p>Ø 开启事务：multi</p>
<p>Ø 作用：设定事务的开启位置，此指令执行后，后续的所有指令均加入到事务中</p>
<p>Ø 执行事务：exec</p>
<p>Ø 作用：设定事务的结束位置，同时执行事务，与multi成对出现，成对使用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image308.jpg" alt="img"></p>
<p>##加入事务的命令暂时进入到任务队列中，并没有立即执行，只有执行exec命令才开始执行</p>
<p>Ø 取消事务：discard</p>
<p>Ø 作用：终止当前事务的定义，发生在multi之后，exec之前</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image310.jpg" alt="img"></p>
<p>l 事务的工作流程</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image312.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image314.jpg" alt="img"></p>
<p>l 事务的注意事项</p>
<p>Ø 定义事务的过程中，命令格式输入错误怎么办？</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 语法错误</p>
<p>指命令书写格式有误</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 处理结果</p>
<p>如果定义的事务中所包含的命令存在语法错误，整体事务中所有命令均不会执行。包括那些语法正确的命令。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image316.jpg" alt="img"></p>
<p>Ø 定义事务的过程中，命令执行出现错误怎么办？</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 运行错误</p>
<p>指命令格式正确，但是无法正确的执行。例如对list进行incr操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 处理结果</p>
<p>能够正确运行的命令会执行，运行错误的命令不会被执行</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image318.jpg" alt="img"></p>
<p>##已经执行完毕的命令对应的数据不会自动回滚，需要程序员自己在代码中实现回滚。</p>
<p>l 手动进行事务回滚</p>
<p>Ø 记录操作过程中被影响的数据之前的状态</p>
<p>单数据：string</p>
<p>多数据：hash、list、 set、zset</p>
<p>Ø 设置指令恢复所有的被修改的项</p>
<p>单数据：直接set（注意周边属性，例如时效）</p>
<p>多数据：修改对应值或整体克隆复制</p>
<p>##redis事务在生产环境中应用相对较少一些</p>
<h3 id="3-1-Redis事务-锁"><a href="#3-1-Redis事务-锁" class="headerlink" title="3-1. Redis事务-锁"></a>3-1. Redis事务-锁</h3><p>l 基于特定条件的事务执行——锁</p>
<p>Ø 业务场景</p>
<p>天猫双11热卖过程中，对已经售罄的货物追加补货，4个业务员都有权限进行补货。补货的操作可能是一系列的操作，牵扯到多个连续操作，如何保障不会重复操作</p>
<p>Ø 业务分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 多个客户端有可能同时操作同组数据，并且该数据一旦被操作修改后，将不适用于继续操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 在操作之前锁定要操作的数据，一旦发生变化，终止当前操作</p>
<p>Ø 解决方案</p>
<p>对key添加监视锁，在执行exec前如果key发生了变化，终止事务执行</p>
<p><strong>watch</strong> key1 [key2…]</p>
<p>取消对所有key的监视</p>
<p><strong>unwatch</strong></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image320.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image322.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image324.jpg" alt="img"></p>
<p>##redis可以应用基于状态控制的批量任务执行</p>
<p>l 基于特定条件的事务执行——分布式锁</p>
<p>Ø 业务场景</p>
<p>天猫双11热卖过程中，对已经售罄的货物追加补货，且补货完成。客户购买热情高涨，3秒内将所有商品购买完毕。本次补货已经将库存全部清空，如何避免最后一件商品不被多人同时购买？【超卖问题】</p>
<p>Ø 业务分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 使用 watch监控—个key有没有改变已经不能解决问题，此处要监控的是具体数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 虽然 redis是单线程的，但是多个客户端刈同一数据同时进行操作时，如何避免不被同时修改？</p>
<p>Ø 解决方法</p>
<p>使用setnx设置一个公共锁</p>
<p>setnx lock-key value</p>
<p>利用 setnx命令的返回值特征，有值则返回设置失败，无值则返回设置成功</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 对于返回设置成功的，拥有控制权，进行下—步的具体业务操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 对于返回设置失败的，不具有控制权，排队或等待</p>
<p>##例如商场试衣间：如果里面无人回应则无值，相当于返回成功你可以使用；</p>
<p>如果里面有人应答则有值，相当于返回失败，你只能排队等待。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image326.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image328.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image330.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image332.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image334.jpg" alt="img"></p>
<p>l 基于特定条件的事务执行——死锁</p>
<p>Ø 业务场景</p>
<p>依赖分布式锁的机制，某个用户操作时对应客户端宕机，且此时已经获取到锁。如何解决？</p>
<p>Ø 业务分析</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 由于锁操作由用户控制加锁解锁，必定会存在加锁后未解锁的风险</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 需要解锁操作不能仅依赖用户控制，系统级别要给出对应的保底处理方案</p>
<p>Ø 解决方案</p>
<p>使用expire为锁key添加时间限定，到时不释放，系统强制解锁</p>
<p><strong>expire</strong> locak-key second</p>
<p><strong>pexpire</strong> local-key milliseconds</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image336.jpg" alt="img"></p>
<h2 id="第四节：Redis过期数据删除策略"><a href="#第四节：Redis过期数据删除策略" class="headerlink" title="第四节：Redis过期数据删除策略"></a>第四节：Redis过期数据删除策略</h2><h3 id="4-1-删除策略"><a href="#4-1-删除策略" class="headerlink" title="4-1. 删除策略"></a>4-1. 删除策略</h3><p>l Redis中数据的特征</p>
<p>Redis是一种内存级数据库，所有数据均存放在内存中，内存中的数据可以通过TTL指令获取其状态</p>
<p>Ø XX：具有时效性的数据</p>
<p>Ø -1：永久有效的数据</p>
<p>Ø -2：已经过期的数据或被删除的数据或未定义的数据</p>
<p>l redis数据删除策略</p>
<p>Ø 定时删除</p>
<p>Ø 惰性删除</p>
<p>Ø 定期删除</p>
<p>l 时效性数据的存储结构</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image338.jpg" alt="img"></p>
<p>l 数据删除策略的目标</p>
<p>在内存占用与CPU占用之间寻找种平衡，顾此失彼都会造成整体 redis性能的下降，甚至引发服务器宕机或内存泄露</p>
<p>l redis过期数据删除策略</p>
<p>Ø 定时删除</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 创建一个定时器，当key设置有过期时间，且过期时间到达时，由定时器任务立即执行对键的删除操作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 优点：节约内存，到时就删除，快速释放掉不必要的内存占用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 缺点：CPU压力很大，无论CPU此时负载量多高，均占用CPU，会影响 Redis服务器响应时间和指令吞叶量</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 总结：用处理器性能换取存储空间（用处理时间换处理空间）</p>
<p>Ø 惰性删除</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据到达过期时间，不做处理。等下次访问该数据时</p>
<p>如果未过期，返回数据</p>
<p>发现已过期，删除，返回不存在</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 优点：节约CPU性能，发现必须删除的时候才删除</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 缺点：内存压力很大，出现长期占用内存的数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 总结：用存储空间换取处理器性能（拿空间换时间）</p>
<p>Ø 定期删除</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image340.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 周期性轮询 redis库中的时效性数据，采用随机抽取的策略，利用过眀数据占比的方式控制删除颎度</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 特点1：CPU性能占用设置有峰值，检测频度可自定义设置</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 特点2：内存压力不是很大，长期占用内存的冷数据会被持续清理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 总结：周期性抽查存储空间（随机抽查，重点抽查）</p>
<p>l 删除策略对比</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image342.jpg" alt="img"></p>
<h3 id="4-2-逐出算法"><a href="#4-2-逐出算法" class="headerlink" title="4-2. 逐出算法"></a>4-2. 逐出算法</h3><p>l 新数据进入检测</p>
<p>Ø Reds使用内存存储数据，在执行每个命令前，会调用freeMemorylfNeeded()检测内存是否充足。如果内存不满足新加入数据的最低存储要求， redis要临时删除些数据为当前指令凊理冇储空间。清理数据的策略称为逐出算法。</p>
<p>Ø 注意：逐出数据的过程不是100%能够清理出足够的可使用的内存空间，如果不成功则反复执行。当对所有数据尝试完毕后，如果不能大到内存清理的要求，将出现错误信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image344.jpg" alt="img"></p>
<p>l 影响数据逐出的相关配置</p>
<p>Ø 最大可使用内存：maxmemory</p>
<p>占用物理内存的比例，默认值为0，表示不限制。生产环境中根据需求设定，通常设置在50%以上。</p>
<p>Ø 每次选取待删除数据的个数：maxmemory-samples</p>
<p>选取数据时并不会全库扫描，导致严重的性能消耗，降低读写性能。因此釆用随机获取数据的方式作为待检测删除数据</p>
<p>Ø 删除策略：maxmemory-policy</p>
<p>达到最大内存后的，对被挑选出来的数据进行删除的策略</p>
<p>Ø 检测易失数据（可能会过去的数据集server.db[i].expires）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> volatile-lru：挑选最近最少使用的数据淘汰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> volatile-lfu：挑选最近使用次数最少的数据淘汰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> volatile-ttl：挑选将要过期的数据淘汰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> volatile-random：任意选择数据淘汰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image346.jpg" alt="img"></p>
<p>Ø 检测全库数据（所有数据集server.db[i].dict）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> allkeys-lru：挑选最近最少使用的数据淘汰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> allkeys-lfu：挑选最近使用次数最少的数据淘汰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> allkeys- random：任意选择数据淘汰</p>
<p>Ø 放弃数据驱逐</p>
<p>no- eviction（驱逐）：禁止驱逐数据（ （redis4.0中默认策略），会引发错淏OOM（ Out Of Memory）</p>
<p>Ø 推荐配置：<strong>maxmemory-policy</strong> volatile-lru</p>
<p>Ø 使用NFO命令输出监控信息，查询绥存hit和miss的次数，根据业务需求调优 Redis配置</p>
<h2 id="第五节：Redis-conf基本配置"><a href="#第五节：Redis-conf基本配置" class="headerlink" title="第五节：Redis.conf基本配置"></a>第五节：Redis.conf基本配置</h2><p>l 服务器端设定</p>
<p>Ø 设置服务器以守护进程的方式运行</p>
<p>daemonize yes Ino</p>
<p>Ø 绑定主机地址（只允许被绑定主机访问）</p>
<p>bina127.0.0.1</p>
<p>Ø 设置服务器端口号</p>
<p>port 6379</p>
<p>Ø 设置数据库数量</p>
<p>databases 16</p>
<p>Ø 设置服务器以指定日志记录级别</p>
<p>loglevel debug I <strong>verbose</strong> l notice Warning</p>
<p>##日志级别开发期设置为 verbose即可，生产环境中配置为notice，简化日志输出量，降低写日志IO的频度</p>
<p>Ø 日志记录文件名</p>
<p>logfile端口号.1og</p>
<p>l 客户端配置</p>
<p>Ø 设置同时间最大客户端连接数，默认无限制。当客户端连接到达上限， Redis会关闭新的连接</p>
<p>maxclients 0</p>
<p>Ø 客户端闲置等待最大时长，达到最大值后关闭连接。如需关闭该功能，设置为0</p>
<p>timeout300</p>
<p>l 多服务器快捷配置</p>
<p>Ø 导入并加载指定配置文件信息，用于快速创建reds公共配置较多的 redis实例配置文件，便于维护</p>
<p>include /path/ server-端口号.conf</p>
<h2 id="第六节：Redis高级数据类型"><a href="#第六节：Redis高级数据类型" class="headerlink" title="第六节：Redis高级数据类型"></a>第六节：Redis高级数据类型</h2><h3 id="6-1-Bitmaps"><a href="#6-1-Bitmaps" class="headerlink" title="6-1. Bitmaps"></a>6-1. Bitmaps</h3><p>l Bitmaps</p>
<p>Ø 获取指定key对应偏移量上的bit值</p>
<p>getbit key offset</p>
<p>Ø 设置指定key对应偏移量上的bit值，value只能是1或0</p>
<p>setbit key offset value</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image348.jpg" alt="img"></p>
<p>l Bitmaps类型的扩展操作</p>
<p>Ø 对指定key按位进行交、并、非、异或操作，并将结果保存到 deskey中</p>
<p><strong>bitop</strong> op destkey key1 [key2…]</p>
<p> and-交、or-并、not-非、xor-异或</p>
<p>Ø 统计指定key中1的数量</p>
<p><strong>bitcount</strong> key [start end]</p>
<h3 id="6-2-HyperLogLog"><a href="#6-2-HyperLogLog" class="headerlink" title="6-2. HyperLogLog"></a>6-2. HyperLogLog</h3><p>l 基数</p>
<p>基数是数据集去重后元素个数</p>
<p>HyperLogLog是用来做基数统计的，运用了 LogLog的算法</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image350.jpg" alt="img"></p>
<p>l HyperLogLog基本操作</p>
<p>Ø 添加数据</p>
<p>pfadd key element [element…]</p>
<p>Ø 统计数据</p>
<p>pfcount key [key…]</p>
<p>Ø 合并数据</p>
<p>pfmerge destkey sourcekey [sourcekey…]</p>
<p>l 相关说明</p>
<p>Ø 用于进行基数统计，不是集合，不保存数据，只记录数量而不是具体数据</p>
<p>Ø 核心是基数估算算法，最终数值存在一定误差</p>
<p>Ø 误差范围：基数估计的结果是一个带有0.81%标准错误的近似值</p>
<p>Ø 耗空间极小，每个 hyperloglog key占用了12K的内存用于标记基数</p>
<p>Ø pfad命令不是次性分配12K内存使用，会随看基数的増加内存逐漸增大</p>
<p>Ø pfmerge命令合并后占用的存储空间为12K，无论合并之前数据量多少</p>
<h3 id="6-3-GEO"><a href="#6-3-GEO" class="headerlink" title="6-3. GEO"></a>6-3. GEO</h3><p>l GEO类型的基本操作</p>
<p>Ø 添加坐标点</p>
<p><strong>geoadd</strong> key longitude latitude member [longitude latitude member…]</p>
<p>Ø 获取坐标点</p>
<p><strong>geopos</strong> key member [member…]</p>
<p>Ø 计算坐标点距离</p>
<p><strong>geodist</strong> key member1 member1 [unit]</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image352.jpg" alt="img"></p>
<p>Ø 根据坐标求范围内的数据</p>
<p><strong>georadius</strong> <em>key longitude latitude radius m|km|ft|mi [withcoord] [withdist] [withhash] [count count]</em></p>
<p>Ø 根据点求范围内数据</p>
<p><strong>georadiusbymember</strong> <em>key member radius m|mk|ft|mi [withcoord] [withdist] [withhash] [count count]</em></p>
<p>Ø 获取执行点对应的坐标hash值</p>
<p><strong>geohash</strong> <em>key member [member…]</em></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image354.jpg" alt="img"></p>
<p>Ø 根据点求范围内数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image356.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image358.jpg" alt="img"></p>
<p>Ø 根据坐标求范围内数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image360.jpg" alt="img"></p>
<h1 id="第三部分：Redis集群"><a href="#第三部分：Redis集群" class="headerlink" title="第三部分：Redis集群"></a>第三部分：Redis集群</h1><h2 id="第一节：主从复制"><a href="#第一节：主从复制" class="headerlink" title="第一节：主从复制"></a>第一节：主从复制</h2><h3 id="1-1-主从复制实现"><a href="#1-1-主从复制实现" class="headerlink" title="1-1.    主从复制实现"></a>1-1.    主从复制实现</h3><p>互联网“三高”架构：高并发、高性能、高可用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image362.jpg" alt="img"></p>
<p>l 单机redis的风险与问题</p>
<p>问题一：机器故障：数据丢失</p>
<p>问题二：容量瓶颈：内存不足</p>
<p>l 多台服务器连接方案</p>
<p>Ø 提供数据方：master</p>
<p>主服务器、主节点、主库、主客户端</p>
<p>Ø 接受数据方：slave</p>
<p>从服务器、从节点、从库、从客户端</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image364.jpg" alt="img"></p>
<p>l 主从复制</p>
<p>Ø 主从复制：即将 master中的数据即时、有效的复制到 slave中</p>
<p>Ø 特征：一个 master可以拥有多个slave，一个slave只对应一个 master</p>
<p>Ø master</p>
<p>写数据</p>
<p>执行写操作时，将出现变化的数据自动同步到slave</p>
<p>读数据（忽略）</p>
<p>Ø slave</p>
<p>读数据</p>
<p>写数据（禁止）</p>
<p>l 高可用集群架构</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image366.jpg" alt="img"></p>
<p>l 主从复制的作用</p>
<p>Ø 读写分离：master写、 slave读，提高服务器的读写负载能力</p>
<p>Ø 负载均衡：基于主从结构，配合读写分离，由 slave分担 master负载，并根据需求的变化，改变 slave的数量，通过多个从节点分担数据读取负载，大大提高 Redis服务器并发量与数据吞吐量</p>
<p>Ø 故障恢复：当 master出现问题时，由 slave提供服务，实现快速的故障恢复</p>
<p>Ø 数据冗余：实现数据热备份，是持久化之外的种数据冗余方式</p>
<p>l 主从复制过程大体可以分为3个阶段</p>
<p>Ø 建立连接阶段（即准备阶段）</p>
<p>Ø 数据同步阶段</p>
<p>Ø 命令传播阶段</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image368.jpg" alt="img">)<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image370.jpg" alt="img"></p>
<p>l 阶段一：建立连接阶段</p>
<p>建立s1ave到 master的连接，使 master能够识别slave，并保存 slave端口号</p>
<p>Ø 步骤1：设置 master的地址和端口，保存 master信息</p>
<p>Ø 步骤2：建立 socket连接</p>
<p>Ø 步骤3：发送ping命令（定时器任务）</p>
<p>Ø 步骤4：身份验证</p>
<p>Ø 步骤5：发送save端囗信息</p>
<p>Ø 至此，主从连接成功！</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image372.jpg" alt="img"></p>
<p>Ø 阶段一配置命令</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 方法一：客户端发送命令</p>
<p><strong>slaveof</strong> <masterip> <masterport></masterport></masterip></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image374.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image376.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 方法二：启动服务器参数</p>
<p>redis-server <strong>–slaveof</strong> <masterip> <masterport></masterport></masterip></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image378.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image380.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 方法三：服务器配置</p>
<p><strong>slaveof</strong> <masterip> <masterport></masterport></masterip></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image382.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image384.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image386.jpg" alt="img"></p>
<p>Ø 授权访问</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image388.jpg" alt="img"></p>
<p>l 阶段二：数据同步</p>
<p>Ø 在slave初次连接 master后，复制 master中的所有数据到 slave</p>
<p>Ø 将slave的数据库状态更新成 master当前的数据库状态</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image390.jpg" alt="img"> </p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 步骤1：请求同步数据   </p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 步骤2：创建RDB同步数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 步骤3：恢复RDB同步数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 步骤4：请求部分同步数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 步骤5：恢复部分同步数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 至此，数据同步工作完成！</p>
<p>Ø 数据同步阶段master说明</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 如果 master数据量巨大，数据同步阶段应避开流暈高峰期，避免造成 master阻塞，影响业务正常执行</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 复制缓冲区大小设定不合理，会导致数据溢出。如进行全量复制周期太长，进行部分复制时发现数据已经存在丢失的情况，必须进行第二次全量复制，致使slave陷入死循环状态。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image392.jpg" alt="img">##缓存区默认大小是1M，应根据实际场景修改</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> master单机内存占用主机内存的比例不应过大，建议使用50%-70%的内存，留下30%-50%的内存用于执行 bgsave命令和创建复制缓冲区</p>
<p>Ø 数据同步阶段slave说明</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 为避免slave进行全量复制部分复制时服务器响应阻塞或数据不同步，建议关闭此期间的对外服务</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image394.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据同步阶段， master发送给slave信息可以理解 master是slave的一个客户端，主动向slave发送命令</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 多个slave同时对 maste请求数据同步， master发送的RDB文件增多，会对带宽造成巨大冲击，如果master带宽不足，因此数据同步需要根据业务需求，适量错峰</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave过多时，建议调整拓扑结构，由一主多从结构变为树状结构，中间的节点既是 master，也是slave。注意使用树状结构时，由于层级深度，导致深度越高的slave与最顶层 master间数据同步延迟较大，数据一致性变差，应谨慎选择</p>
<p>#####################################################################</p>
<p>l 阶段三：命令传播阶段</p>
<p>Ø 命令传播阶段的部分复制</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令传播阶段出现断网现象</p>
<p>网络闪断闪连      忽略</p>
<p>网络短时间中断    部分复制</p>
<p>网络长时间中断    全量复制</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 部分复制的三个核心要素</p>
<p>服务器的运行ID（run id）</p>
<p>主服务器的复制积压缓存区</p>
<p>主从服务器的复制偏移量</p>
<p>Ø <strong>服务器运行ID</strong></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 概念：服务器运行I是每一台服务器每欠运行的身份识别码，一台服务器多次运行可以生成多个运行id</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 组成：运行id由40位字符组成，是一个随机的十六进制字符</p>
<p>例如154：fdc9ff13b9bbaab28db42b3d50f852bb5e3fcdce</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用：运行id被用于在服务器间进行传输，识别身份</p>
<p>如果想两次操作均对同台服务器进行，必须每次操作携带对应的运行id，用于对方识别</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 实现方式：运行id在每台服务器启动时自动生成的， master在首次连接slave时，会将自己的运行ID发送给slave, slave保存此id，通过 info server命令，可以查看节点的 runid</p>
<p>Ø <strong>复制缓冲区</strong></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 概念：复制缰冲区，又名复制积压缓冲区，是一个先进先出（F”O）的队列，用于存储服务器执行过的命令，每次传播命令， master都会将传播的命令记录下来，并存储在复制缓冲区</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image396.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 复制缓冲区内部工作原理</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image398.jpg" alt="img"></p>
<p>复制缓冲区默认数据存储空间大小是1M，由于存储空间大小是固定的，当入队元素的数量大于列长度时，最先入队的元素会被弹出，而新元素会被放入队列</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 由来：每台服务器启动时，如果开启有AOF或被连接成为 master节点，即创建复制缓冲区</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用：用于保存 master收到的所有指令（仅影响数据变更的指令，例如set, select</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据来源：当 master接收到主客户端的指令时，除了将指令执行，会将该指令存储到缓冲区中</p>
<p>Ø 主从服务器复制偏移量（offset）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 概念：一个数字，描述复制缓冲区中的指令字节位置</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 分类：</p>
<p>\1.    master复制偏移量：记录发送给所有s1ave的指令字节对应的位置（多个）</p>
<p>\2.    slave复制偏移量：记录s1ave接收 master发送过来的指令字节对应的位置（个）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 数据来源：</p>
<p>\1.    master端：发送一次记录次</p>
<p>\2.    slave端：接收一次记录次</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用：同步信息，比对 master与 slave的差异，当slave断线后，恢复数据使用</p>
<p>l 数据同步+命令传播阶段工作流程</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image400.jpg" alt="img"></p>
<p>l 心跳机制</p>
<p>进入命令传播阶段候， master与slave间需要进行信息交换，使用心跳机制进行维护，实现双方连接保持在线</p>
<p>Ø master心跳</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 指令：PING</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 周期：由 repl-ping-slave-period决定，默认10秒</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用：判断 slave是否在线</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 查询：INFO replication获取 slave最后一次连接时间间隔，lag项维持在0或1视为正常</p>
<p>Ø slave心跳任务</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 指令：REPLCONF ACK{offset}</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 周期：1秒</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用1：汇报slave自己的复制偏移量，获取最新的数据变更指令</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用2：判断 master是否在线</p>
<p>Ø 心跳阶段注意事项</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 当 slave多数掉线，或延迟过高时， master为保暲数据稳定性，将拒绝所有信息同步操作</p>
<p>min-slaves-to-write 2</p>
<p>min-slave-max-lag 8</p>
<p>##slave数量少于2个，或者所有save的延迟都大于等于10秒时，强制关闭 master写功能，停止数据同步</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave数量由slave发送 REPLCONF ACK命令做确认</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave延迟由slave发送 REPLCONF ACK命令做确认</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image402.jpg" alt="img"></p>
<h3 id="1-2-主从复制常见问题"><a href="#1-2-主从复制常见问题" class="headerlink" title="1-2.    主从复制常见问题"></a>1-2.    主从复制常见问题</h3><p>l 频繁全量复制（1）</p>
<p>伴随着系统的运行， master的数据量会越来越大，一旦 master重启， runid将发生变化，会导致全部slave的全量复制操作</p>
<p>Ø 内部优化调整方案</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> master内部创建 master_replid变量，使用 runid相同的策略生成，长度41位，并发送给所有slave</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 在master关闭时执行命令shutdown save，进行RDB持久化，将runid与offset保存到RDB文件中</p>
<p>   repl-id  repl-offset</p>
<p>   通过redis-check-rdb命令可以查看RDB文件查看该信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> master重启后加载RDB文件，恢复数据</p>
<p>重启后，将RDB文件中保存的repl-id与repl-offset加载到内存中</p>
<p>  master_repl_id = repl  master_repl_offset = repl-offset</p>
<p>  通过info命令可以查看该信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 作用：本机保存上次runid（运行id），重启后恢复该值，使所有salve认为还是之前的master</p>
<p>l 频繁全量复制（2）</p>
<p>Ø 问题现象：网络环境不佳，出现网络中断，slave不提供服务</p>
<p>Ø 问题原因：复制缓冲区过小，断网后slave的offset（偏移量）越界，出发全量复制</p>
<p>Ø 最终结果：slave反复进行全量复制</p>
<p>Ø 解决方案：修改复制缓冲区大小</p>
<p>repl-backlog-size</p>
<p>Ø 建议设置如下：</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 测算从master到slave的重连平均时长second</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 获取master平均每秒产生写命令数据总量write_size_per_second</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 最优复制缓冲区空间 = 2 * second * write_seze_per_second</p>
<p>l 频繁网络中断（1）</p>
<p>Ø 问题现象：master的cpu占用过高或 slave频繁断开连接</p>
<p>Ø 可题原因：</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave每1秒发送 REPLCONE ACK命令到 master</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 当slave接到了慢查询时（keys*， hgeta11等），会大量占用cpu性能</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> master每1秒调用复制定时函数 replicationcron（），比对slave发现长时间没有进行响应</p>
<p>Ø 最终结果：master各种资源（输出缓中区、带宽连接等）被严重占用</p>
<p>Ø 解决方案：通过设置合理的超时时间，确认是否释放slave</p>
<p>repl-timeout</p>
<p>Ø 该参数定义了超时时间的阈值（默认60秒），超过该值，释放slave</p>
<p>l 频繁网络中断（2）</p>
<p>Ø 问题现象：s1ave与 master连接断开</p>
<p>Ø 问题原因：</p>
<p>master发送ping指令频度较低</p>
<p>master设定超时时间较短</p>
<p>ping指令在网络中存在丢包</p>
<p>Ø 解决方案：提高ping指令发送的频度</p>
<p>repl-ping-slave-period</p>
<p>##超时时间repl-time的时间至少是ping指令频度的5到10倍，否则slave很容易判定超时</p>
<p>l 数据不一致</p>
<p>Ø 问题现象：多个slave获取相同数据不同步</p>
<p>Ø 问题原因：网络信息不同步，数据发送有延迟</p>
<p>Ø 解决方案：</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 优化主从间的网络环境，通常放置在同一个机房部署，如使用阿里云等云服务器时要注意此现象</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 监控主从节点延迟（通过 offset）判断，如果slave延迟过大，暂时屏蔽程序对该 slave的数据访问</p>
<p>slave-servve-stale-data yes|no</p>
<p>##开启后仅响应info、 slaved侉等少数命令（慎用，除非对数据一致性要求很髙）</p>
<h2 id="第二节：哨兵模式"><a href="#第二节：哨兵模式" class="headerlink" title="第二节：哨兵模式"></a>第二节：哨兵模式</h2><h3 id="2-1-哨兵模式构建"><a href="#2-1-哨兵模式构建" class="headerlink" title="2-1. 哨兵模式构建"></a>2-1. 哨兵模式构建</h3><p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image404.jpg" alt="img"></p>
<p>l 哨兵</p>
<p>哨兵（ sentinel）是—个分布式系统，用于对主从结构中的每台服务器进行监控，当出现故障时通过投票机制选择新的master并将所有save连接到新的 master。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image406.jpg" alt="img"></p>
<p>Ø 哨兵的作用</p>
<p>Ø 监控</p>
<p>不断的检查 master和save是否正常运行。</p>
<p>master存活检测、 master与 slave运行情况检测</p>
<p>Ø 通知（提醒）</p>
<p>当被监控的服务器出现问题时，向其他（哨兵间，客户端）发送通知。</p>
<p>Ø 自动故障转移</p>
<p>断开 master与slave连接，选取一个 slave作为 master，将其他 slave连接到新的 master，并告知客户端新的服务器地址</p>
<p>##哨兵也是一台 redis服务器，只是不提供数据服务通常哨兵配置数量为单数</p>
<p>l 启用哨兵模式</p>
<p>Ø 配置哨兵</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 配置一拖二的主从结构</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 配置三个哨兵（配置相同，端口不同）</p>
<p>参看 sentinel. conf</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 启动哨兵</p>
<p><strong>redis-sentinel</strong> sentinel-端口号.conf</p>
<p>Ø sentinel.conf配置文件</p>
<p>[root@goaccess redis]# cat sentinel.conf | grep -v “#” | grep -v “^$”</p>
<p>port 26379</p>
<p>daemonize no</p>
<p>pidfile /var/run/redis-sentinel.pid</p>
<p>logfile “”</p>
<p>dir /tmp</p>
<p>sentinel monitor mymaster 127.0.0.1 6379 2 ##哨兵数量，此处的2意思为：有两个哨兵认为master宕机，才真的判定为宕机，一般配置为哨兵总数(n/2+1)个</p>
<p>sentinel down-after-milliseconds mymaster 30000（毫秒单位） ##判断master宕机的超时时间</p>
<p>sentinel parallel-syncs mymaster 1 ##新master上线后，几台slave进行同时同步</p>
<p>sentinel failover-timeout mymaster 180000 ##同步超时时间</p>
<p>sentinel deny-scripts-reconfig yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image408.jpg" alt="img"></p>
<p>l 哨兵构建实战模拟</p>
<p>Ø 准备三台sentine配置文件</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> sentinel-27379.conf</p>
<p>port 26379</p>
<p>daemonize no</p>
<p>pidfile /var/run/redis-sentinel.pid</p>
<p>logfile “”</p>
<p>dir /tmp</p>
<p>sentinel monitor mymaster 127.0.0.1 6379 2</p>
<p>sentinel down-after-milliseconds mymaster 30000</p>
<p>sentinel parallel-syncs mymaster 1</p>
<p>sentinel failover-timeout mymaster 180000</p>
<p>sentinel deny-scripts-reconfig yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> sentinel-27380.conf</p>
<p>port 26380</p>
<p>daemonize no</p>
<p>pidfile /var/run/redis-sentinel.pid</p>
<p>logfile “”</p>
<p>dir /tmp</p>
<p>sentinel monitor mymaster 127.0.0.1 6379 2</p>
<p>sentinel down-after-milliseconds mymaster 30000</p>
<p>sentinel parallel-syncs mymaster 1</p>
<p>sentinel failover-timeout mymaster 180000</p>
<p>sentinel deny-scripts-reconfig yes</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> sentinel-27381.conf</p>
<p>port 26381</p>
<p>daemonize no</p>
<p>pidfile /var/run/redis-sentinel.pid</p>
<p>logfile “”</p>
<p>dir /tmp</p>
<p>sentinel monitor mymaster 127.0.0.1 6379 2</p>
<p>sentinel down-after-milliseconds mymaster 30000</p>
<p>sentinel parallel-syncs mymaster 1</p>
<p>sentinel failover-timeout mymaster 180000</p>
<p>sentinel deny-scripts-reconfig yes</p>
<p>Ø 准备一台master和两台slave配置文件</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> master-6379.conf</p>
<p>port 6379</p>
<p>daemonize no</p>
<p>#logfile “6379.log”</p>
<p>dir /usr/local/redis/log</p>
<p>dbfilename dump-6379.rdb</p>
<p>rdbcompression yes</p>
<p>rdbchecksum yes</p>
<p>save 10 2</p>
<p>appendonly yes</p>
<p>appendfsync always</p>
<p>appendfilename appendonly-6379.aof</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave-6380.conf</p>
<p>port 6380</p>
<p>daemonize no</p>
<p>#logfile “6379.log”</p>
<p>dir /usr/local/redis/log</p>
<p>dbfilename dump-6380.rdb</p>
<p>rdbcompression yes</p>
<p>rdbchecksum yes</p>
<p>save 10 2</p>
<p>appendonly yes</p>
<p>appendfsync always</p>
<p>appendfilename appendonly-6380.aof</p>
<p>slaveof 127.0.0.1 6379</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave-6381.conf</p>
<p>port 6381</p>
<p>daemonize no</p>
<p>#logfile “6379.log”</p>
<p>dir /usr/local/redis/log</p>
<p>dbfilename dump-6381.rdb</p>
<p>rdbcompression yes</p>
<p>rdbchecksum yes</p>
<p>save 10 2</p>
<p>appendonly yes</p>
<p>appendfsync always</p>
<p>appendfilename appendonly-6381.aof</p>
<p>slaveof 127.0.0.1 6379</p>
<p>Ø 启动master、slave和sentinel</p>
<p>##启动顺序：先master、再slave、最后sentine</p>
<p>\1.    [root@host redis]#src/redis-server conf/redis-6379.conf</p>
<p>\2.    [root@host redis]#src/redis-server conf/redis-6380.conf</p>
<p>\3.    [root@host redis]#src/redis-server conf/redis-6380.conf</p>
<p>\4.    [root@host redis]#src/redis-sentinel conf/sentinel-26379.conf</p>
<p>\5.    [root@host redis]#src/redis-sentinel conf/sentinel-26380.conf</p>
<p>\6.    [root@host redis]#src/redis-sentinel conf/sentinel-26381.conf</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image410.jpg" alt="img"></p>
<p>Ø 将master手动down机观察切换情况</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image412.jpg" alt="img"></p>
<h3 id="2-2-哨兵模式原理"><a href="#2-2-哨兵模式原理" class="headerlink" title="2-2. 哨兵模式原理"></a>2-2. 哨兵模式原理</h3><p>哨兵进行主从切换的三个过程：监控、通知、故障转移</p>
<p>l 阶段一：监控阶段</p>
<p>Ø 用于同步各个节点的状态信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 获取各个 sentinel的状态（是否在线）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 获取 master的状态</p>
<p>master属性runid 、role:master</p>
<p>各个save的详细信息</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 获取所有 slave的状态（根据 master中的 slave信息）</p>
<p>slave属性：runid、role：slave、master_host、master_port、offset。。。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image414.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image416.jpg" alt="img"></p>
<p>l 阶段二：通知阶段</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image418.jpg" alt="img"></p>
<p>l 阶段三：故障转移阶段</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image420.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image422.jpg" alt="img"></p>
<p>Ø sentinel在服务器列表中挑选备用master</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 剔除非在线服务器</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 剔除响应缓慢的</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 剔除与原master断开时间久的</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 优选原则：优先级、offset、runid</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image424.jpg" alt="img"></p>
<p>Ø 发送指令（sentinel）</p>
<p>向新的 master发送 slaveof no one</p>
<p>向其他slave发送 slaveof新 masterIP端口</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image426.jpg" alt="img"></p>
<h2 id="第三节：Redis集群"><a href="#第三节：Redis集群" class="headerlink" title="第三节：Redis集群"></a>第三节：Redis集群</h2><h3 id="3-1-Redis集群原理"><a href="#3-1-Redis集群原理" class="headerlink" title="3-1. Redis集群原理"></a>3-1. Redis集群原理</h3><p>l 现状问题：</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> redis提供的服务OPS可以达到10万/秒，当前业务OPS已经达到20万/秒</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 内存单机容量达到256G，当前业务需求内存容量1T</p>
<p>ü 使用集群的方式可以快速解决上述问题</p>
<p>l 集群架构</p>
<p>集群就是使用网络将若干台计算机联通起来，并提供统-的管理方式，使其对外呈现单机的服努效果</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image428.jpg" alt="img"></p>
<p>l 集群作用</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 分散单台服务器的访问压力，实现负载均衡</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 分散单台服务器的存储压力，实现可扩展性</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 降低单台服务器宕机带来的业务灾难</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image430.jpg" alt="img"></p>
<p>l Redis集群结构设计</p>
<p>Ø 数据存储设计</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 通过算法设计，计算出key应该保存的位置</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将所有的存储空间计划切割成16384份，每台主机保存一部分</p>
<p>每份代表的是一个存储空间，不是一个key的保存空间</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将key按照计算出的结果放到对应的存储空间</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image432.jpg" alt="img"></p>
<p>Ø 增强可扩展性</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image434.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image436.jpg" alt="img"></p>
<h3 id="3-2-Redis集群搭建"><a href="#3-2-Redis集群搭建" class="headerlink" title="3-2. Redis集群搭建"></a>3-2. Redis集群搭建</h3><p>l 配置文件新增cluster相关配置</p>
<p>cluster-enabled yes ##启用cluster</p>
<p>cluster-config-file nodes-6379.conf ##创建cluster对应的配置文件</p>
<p>cluster-node-timeout 10000 ##cluster节点主机超时时间</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image438.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image440.jpg" alt="img"></p>
<p>Ø 关联集群节点</p>
<p>使用src/redis-trib.rb关联cluster节点</p>
<p>使用前提：需要有ruby和gem</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image442.jpg" alt="img"></p>
<p>./redis-trib.rb create –replicas 1 127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384</p>
<p>##–replicas 1：集群主从关系是一对一，后面跟写双数位主机，前面一半是master，后面一半是slave 并且从头到尾一一对应</p>
<p>##比如有六台主机，那么master-slave关系为：1-4、2-5、3-6</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image444.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image446.jpg" alt="img"></p>
<p>Ø cluster集群客户端</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image448.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image450.jpg" alt="img"></p>
<h3 id="3-3-Redis集群故障演练"><a href="#3-3-Redis集群故障演练" class="headerlink" title="3-3. Redis集群故障演练"></a>3-3. Redis集群故障演练</h3><p>Ø slave宕机故障演练</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave1手动宕机</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image452.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> slave1手工恢复</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image454.jpg" alt="img"></p>
<p>Ø master1宕机故障演练</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image456.jpg" alt="img"></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image458.jpg" alt="img"></p>
<p>##master1恢复上线后成为新master1的slave1的slave（经过down/up，master1和slave1进行了角色互换）</p>
<p>l Cluster配置</p>
<p>Ø 设置接入cluster，成为其中的节点</p>
<p>cluster-enabled yes|no</p>
<p>Ø cluster配置文件名，该文件属于自动生成，仅用于快速查找文件并查询文件内容</p>
<p>cluster-config-file <filename></filename></p>
<p>Ø 节点服务响应超时时间，用于判定该节点是否下线或切换为从节点</p>
<p>cluster-node-timeout <milliseconds></milliseconds></p>
<p>Ø master连接的slave最小数量</p>
<p>cluster-migration-barrier <count></count></p>
<p>l Cluster节点操作命令</p>
<p>Ø 查看集群节点信息</p>
<p>cluster nodes</p>
<p>Ø 进入一个从节点redis，切换其主节点</p>
<p>cluster replicate <master-id></master-id></p>
<p>Ø 发现一个新节点，新增主节点</p>
<p>cluster meet ip:port</p>
<p>Ø 忽略一个没有solt的节点</p>
<p>cluster forget <id></id></p>
<p>Ø 手动故障转移</p>
<p>cluster failover</p>
<p>Redis集群相关参考文章：</p>
<p><a href="https://www.cnblogs.com/yinyunmoyi/p/11525680.html" target="_blank" rel="noopener">https://www.cnblogs.com/yinyunmoyi/p/11525680.html</a></p>
<p><a href="https://blog.csdn.net/javahongxi/article/details/79500891" target="_blank" rel="noopener">https://blog.csdn.net/javahongxi/article/details/79500891</a></p>
<h1 id="第四部分：企业级解决方案"><a href="#第四部分：企业级解决方案" class="headerlink" title="第四部分：企业级解决方案"></a>第四部分：企业级解决方案</h1><h2 id="4-1-缓存预热"><a href="#4-1-缓存预热" class="headerlink" title="4-1. 缓存预热"></a>4-1. 缓存预热</h2><p>问题：服务器启动后迅速宕机</p>
<p>排查：请求数量较高、主从之间数据吞吐量较大，数据同步操作频度较高</p>
<p>l 解决方案：</p>
<p>Ø 前置准备工作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 日常例行统计数据访问记录，统计访冋频度较高的热点数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 利用LR∪数据删除策略，构建数据留存队列</p>
<p>例如：stom与 kafka配合</p>
<p>Ø 准备工作</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 将统计结果中的数据分类，根据级别， redis优先加载级别较高的热点数据</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 利用分布式多服务器同时进行数据读取，提速数据加载过程</p>
<p>Ø 实施</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 使用脚本程序固定触发数据预热过程</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 如果条件允许，使用了CDN（内容分发网络），效果会更好</p>
<p>Ø 总结</p>
<p>缓存预热就是系统启动前，提前将相关的缓冇数据直接加载到爰存系统。避免在用户请求的时候，先査询数据库，然后再将数据缓存的问题！用户直接査询事先被预热的缓存数据！</p>
<p>参考文章：<a href="https://blog.csdn.net/mn_kw/article/details/80704611" target="_blank" rel="noopener">https://blog.csdn.net/mn_kw/article/details/80704611</a></p>
<h2 id="4-2-缓存雪崩"><a href="#4-2-缓存雪崩" class="headerlink" title="4-2. 缓存雪崩"></a>4-2. 缓存雪崩</h2><p>Ø 数据库服务器崩溃</p>
<p>1.系统平稳运行过程中，忽然数据库连接量激缯</p>
<p>2.应用服务器无法及时处理请求</p>
<p>3.大量408,500错误页面出现</p>
<p>4.客户反复刷新页面获取数据</p>
<p>5.数据库崩溃</p>
<p>6.应用服务器崩溃</p>
<p>7.重启应用服务器无效</p>
<p>\8. Redis服务器崩溃</p>
<p>\9. Redis集群崩溃10.重启数据库后再次被瞬间流量放倒</p>
<p>Ø 问题排查</p>
<p>1.在一个较短的时间内，缓存中较多的key集中过期</p>
<p>2.此周期内请求访问过期的数据， redis未命中， redis向数据库获取数据</p>
<p>3.数据库同时接收到大量的请求无法及时处理</p>
<p>\4. Redis大量请求被积压，开始出现超时瓊象</p>
<p>5.数据库流量激增，数据库崩溃</p>
<p>6.重启后仍然面对缓存中无数据可用</p>
<p>\7. Redis服务器资源被严重占用， Redis服务器崩溃</p>
<p>\8. Redis集群呈现崩塌，集群瓦解</p>
<p>9.应用服务器无法及时得到数据响应请求，来自客户端的请求数量越来越多，应用服务器崩溃</p>
<p>10.应用服务器， redis，数据库全部重启，效果不理想</p>
<p>Ø 问题分析（道）</p>
<p>\1.   短时间范围内</p>
<p>\2.   大量key集中过去</p>
<p>Ø 解决方案</p>
<p>\1.   更多的页面静态化处理</p>
<p>\2.   构建多级缓存架构</p>
<p>Nginx缓存+ redis缓存+ ehcache缓存</p>
<p>\3.   检测Mysq严重耗时业务进行优化</p>
<p>对数据库的瓶颈排查：例如超时查询、耗时较高事务等</p>
<p>\4.   灾难预警机制</p>
<p>监控 redis服务器性能指标</p>
<p>ü CPU占用、CPU使用率</p>
<p>ü 内存容量查询</p>
<p>ü 平均响应时间</p>
<p>ü 线程数</p>
<p>\5.   限流、降级</p>
<p>短时间范围内牺牲一些客户体验，限制部分请求访问，降低应用服务器压力，待业务低束运转后再逐步放开访问</p>
<p>Ø 解决方案（术）</p>
<p>\1.   LRU与LFU切换</p>
<p>\2.   数据有效期策略调整</p>
<p>根据业务数据有效期进行分类错峰，A类90分钟，B类80分钟，C类70分钟</p>
<p>过期时间使用固定时间+随机值的形式，稀释集中到期的key的数量</p>
<p>\3.   超热数据使用永久key</p>
<p>\4.   定期维护（自动+人工）</p>
<p>对即将过期数据做访问量分析，确认是否延时，配合访问量统计，做热点数据的延旳</p>
<p>\5.   加锁慎用！</p>
<p>Ø 总结</p>
<p>缓存雪崩就是瞬间过賏数据量太大，导致对数据库服努器造成压力。如能够有效避免过眀时间集中，可以有效解决雪崩现象的岀现（约40%），配合其他策略起使用，并监控服务器的运行数据，根据运行记录做快速调整。</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image460.jpg" alt="img"></p>
<p>参考文章：<a href="https://www.cnblogs.com/weigy/p/12666881.html" target="_blank" rel="noopener">https://www.cnblogs.com/weigy/p/12666881.html</a></p>
<p><a href="https://blog.csdn.net/qq_29373285/article/details/88544299" target="_blank" rel="noopener">https://blog.csdn.net/qq_29373285/article/details/88544299</a></p>
<p><a href="https://www.cnblogs.com/chengege/p/11073225.html" target="_blank" rel="noopener">https://www.cnblogs.com/chengege/p/11073225.html</a></p>
<h2 id="4-3-缓存击穿"><a href="#4-3-缓存击穿" class="headerlink" title="4-3. 缓存击穿"></a>4-3. 缓存击穿</h2><p>数据库服务器崩溃</p>
<p>1.系统平稳运行过程中</p>
<p>2.数据库连接量瞬间激增3.Reds服务器无大量key过期</p>
<p>\4. Redis内存平稳，无波动</p>
<p>\5. Redis服务器CPU正常</p>
<p>6.数据库崩溃</p>
<p>Ø 问题排查</p>
<p>\1. Redis中某个key过期，该key访问量巨大</p>
<p>2.多个数据请求从服务器直接压到 Redis后，均未命中</p>
<p>\3. Redis在短时间内发起了大量对数据库中同数据的访问</p>
<p>Ø 问题分析</p>
<p>单个key高热数据、key过期</p>
<p>Ø 解决方案（术）</p>
<p>\1.   预先设定</p>
<p>以电商为例，每个商家根据店铺等级，指定若干款主打商品，在购物节期间，加大此类信息key的过期时长</p>
<p>注意：购物节不仅仅指当天，以及后续若干天，访问峰值呈现逐渐降低的趋势</p>
<p>\2.   现场调整</p>
<p>监控访问量，对自然流量激增的数据延长过期时间或设置为永久性key</p>
<p>\3.   后台刷新数据</p>
<p>启动定时任务，高峰期来临之前，局新数据有效期，确保不丟失</p>
<p>\4.   二级缓存</p>
<p>设置不同的失效时间，保障不会被同时淘汰就行</p>
<p>\5.   加锁</p>
<p>分布式锁，防止被击穿，但是要注意也是性能瓶颈，慎重！</p>
<p>Ø 总结</p>
<p>缓存击穿就是单个高热数据过期的瞬间，数据访问量较大，未命中 redis后，发起了大量对同数据的数据库访问，导致对数据库服务器造成压力。应对策略应该在业务数据分析与预防方面进行，配合运行监控测试与即时调整策略，毕竟单个key的过期监控难度较高，配合雪崩处理策略即可。</p>
<p>参考文章：<a href="https://www.php.cn/redis/423814.html" target="_blank" rel="noopener">https://www.php.cn/redis/423814.html</a></p>
<p><a href="https://blog.csdn.net/qq_32967665/article/details/86491095" target="_blank" rel="noopener">https://blog.csdn.net/qq_32967665/article/details/86491095</a></p>
<p><a href="https://www.cnblogs.com/wangwust/p/9467720.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangwust/p/9467720.html</a></p>
<p>更多参考：<a href="https://www.cnblogs.com/leeSmall/p/8594542.html" target="_blank" rel="noopener">https://www.cnblogs.com/leeSmall/p/8594542.html</a></p>
<p><a href="https://www.cnblogs.com/leeSmall/p/8594542.html" target="_blank" rel="noopener">https://www.cnblogs.com/leeSmall/p/8594542.html</a></p>
<h2 id="4-4-缓存穿透"><a href="#4-4-缓存穿透" class="headerlink" title="4-4. 缓存穿透"></a>4-4. 缓存穿透</h2><p>数据库服务器崩溃</p>
<p>1.系统平稳运行过程中</p>
<p>2.应用服务器流量随时间增量较大</p>
<p>\3. Redis服务器命中率时间逐步降低</p>
<p>\4. Redis内存平稳，内存无压力</p>
<p>\5. Redis服务器CPU占用激增</p>
<p>6.数据库服务器压力激增</p>
<p>7.数据库崩溃</p>
<p>Ø 故障排查</p>
<p>redis中大面积出现未命中、出现非正常url访问</p>
<p>Ø 问题分析</p>
<p>\1.    获取的数据在数据库中也不存在，数据库查询未得到对应数据</p>
<p>\2.    Redis获取到null数据未进行持久化，直接返回</p>
<p>\3.    下次此类数据到达重复上述过程</p>
<p>\4.    出现黑客攻击服务器</p>
<p>Ø 解决方案（术）</p>
<p>\1.   缓存null</p>
<p>对查询结果为null的数据进行缓存（长期使用，定期清理），设定短时限，例如30-60秒，最高5分钟</p>
<p>\2.   白名单策略</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 提前预热各种分类数据d对应的 bitmaps,id作为 bitmaps的offset，相当于设置了数据白名单。当加载正常数据时，放行，加载异常数据时直接拦截（效率偏低）</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 使用布隆过滤器（有关布隆过滤器的命中问题对当前状况可以忽略</p>
<p>\3.   实施监控</p>
<p>实时监控 Redis命中率（业务正常范围时，通常会有一个波动值）与null数据的占比</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 非活动时段波动：通常检测3-5倍，超过5倍纳入重点排查对象</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 活动时段波动：通常检测10-50倍，超过50倍纳入重点排查象</p>
<p>根据倍数不同，启动不同的排查流程。然后使用黑名单进行防控（运营）</p>
<p>\4.   key加密</p>
<p>问题出现后，临时启动灾业务key，对key进行业务层传输加密服务，设定校验程序，过来的key校验</p>
<p>例如每天随机分配60个加密串，挑选2到3个，混淆到页面数据id中，发现访问key不满足规则，驳回数据访问</p>
<p>Ø 总结</p>
<p>缀存穿透访问了不存在的数据，跳过了合法数据的 Redis数据缓存阶段，毎欠访冋数据库，导致对数据库服努器造成压力。通常此类数据的出现量是一个较低的值，当岀现此类情况以毒攻毒，并及时报警。应对策略应该在临时预案防范方面多做文章。</p>
<p>无论是黑名单还是白名单，都是对整体系统的压力，警报解除后尽快移除。</p>
<p>参考文章：<a href="https://segmentfault.com/a/1190000017305460" target="_blank" rel="noopener">https://segmentfault.com/a/1190000017305460</a></p>
<p><a href="https://blog.csdn.net/it_townlet/article/details/88217607" target="_blank" rel="noopener">https://blog.csdn.net/it_townlet/article/details/88217607</a></p>
<p>#####################################################################</p>
<p>更多参考资料：</p>
<p><a href="http://java.isture.com/redis/question/Redis缓存预热.html" target="_blank" rel="noopener">http://java.isture.com/redis/question/Redis%E7%BC%93%E5%AD%98%E9%A2%84%E7%83%AD.html</a></p>
<p><a href="https://www.cnblogs.com/leeSmall/p/8594542.html" target="_blank" rel="noopener">https://www.cnblogs.com/leeSmall/p/8594542.html</a></p>
<p><a href="http://baijiahao.baidu.com/s?id=1645711243396815547&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">http://baijiahao.baidu.com/s?id=1645711243396815547&amp;wfr=spider&amp;for=pc</a></p>
<p>其他人笔记整理：<a href="https://blog.csdn.net/branwel/article/details/103897256" target="_blank" rel="noopener">https://blog.csdn.net/branwel/article/details/103897256</a></p>
<h2 id="4-5-性能监控"><a href="#4-5-性能监控" class="headerlink" title="4-5. 性能监控"></a>4-5. 性能监控</h2><p>l 监控指标</p>
<p>Ø 性能指标：Performance</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image462.jpg" alt="img"></p>
<p>Ø 内存指标：Memory</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image464.jpg" alt="img"></p>
<p>Ø 基本活动指标：Basic activity</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image466.jpg" alt="img"></p>
<p>Ø 持久性指标：Persistence</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image468.jpg" alt="img"></p>
<p>Ø 错误指标：Error</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image470.jpg" alt="img"></p>
<p>l 监控方式</p>
<p>Ø 工具类</p>
<p>Cloud Insight redis</p>
<p>Prometheus</p>
<p>ledis-stat Redis-faina</p>
<p>Redislive</p>
<p>zabbix</p>
<p>Ø 命令类</p>
<p>benchmark</p>
<p>redis-cli</p>
<p>  monitor</p>
<p>  showlog</p>
<p>Ø benchmark压测命令</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令</p>
<p>redis-benchmark [-h] [-p] [-c] [-n <request>] [-k]</request></p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 示例</p>
<p>redis-benchmark –c 100 –n5000 #100个连接，5000次请求对应的性能</p>
<p>Ø showlog</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 命令</p>
<p>showlog [operator]</p>
<p> get：获取慢查询日志</p>
<p> len：获取慢查询日志条目数</p>
<p> reset：重置慢查询日志</p>
<p><img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image001.gif" alt="*"> 相关配置</p>
<p>show-log-slower-than 1000 #设置难查询的时间下线，单位：微妙</p>
<p>show-max-len 100 #设置慢查询命令对应的日志显示长度，单位：命令数</p>
<p>完结！撒花！<img src="/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/clip_image471.gif" alt="img"></p>

    </div>

    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>晓晨
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yoursite.com/2020/06/03/Redis%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Redis学习笔记">http://yoursite.com/2020/06/03/Redis学习笔记/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/06/03/Tomcat%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="prev" title="Tomcat学习笔记">
      <i class="fa fa-chevron-left"></i> Tomcat学习笔记
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Redis学习课程安排"><span class="nav-number">1.</span> <span class="nav-text">Redis学习课程安排</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第一部分：Redis基础"><span class="nav-number">2.</span> <span class="nav-text">第一部分：Redis基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一节：Redis入门"><span class="nav-number">2.1.</span> <span class="nav-text">第一节：Redis入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Redis简介"><span class="nav-number">2.1.1.</span> <span class="nav-text">1-1.    Redis简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Redis部署"><span class="nav-number">2.1.2.</span> <span class="nav-text">1-2.    Redis部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-Redis基本操作"><span class="nav-number">2.1.3.</span> <span class="nav-text">1-3.    Redis基本操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二节：Redis数据类型"><span class="nav-number">2.2.</span> <span class="nav-text">第二节：Redis数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Redis数据类型之string"><span class="nav-number">2.2.1.</span> <span class="nav-text">2-1. Redis数据类型之string</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Redis数据类型之hash"><span class="nav-number">2.2.2.</span> <span class="nav-text">2-2. Redis数据类型之hash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Redis数据类型之list"><span class="nav-number">2.2.3.</span> <span class="nav-text">2-3. Redis数据类型之list</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Redis数据类型之set"><span class="nav-number">2.2.4.</span> <span class="nav-text">2-4. Redis数据类型之set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-Redis数据类型之sorted-set"><span class="nav-number">2.2.5.</span> <span class="nav-text">2-5. Redis数据类型之sorted_set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-Redis数据类型综合实践案例"><span class="nav-number">2.2.6.</span> <span class="nav-text">2-6. Redis数据类型综合实践案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三节：Redis通用命令"><span class="nav-number">2.3.</span> <span class="nav-text">第三节：Redis通用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Redis通用命令之key通用操作"><span class="nav-number">2.3.1.</span> <span class="nav-text">3-1. Redis通用命令之key通用操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Redis通用命令之DB通用操作"><span class="nav-number">2.3.2.</span> <span class="nav-text">3-2. Redis通用命令之DB通用操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第四节：Redis与java连接工具jedis"><span class="nav-number">2.4.</span> <span class="nav-text">第四节：Redis与java连接工具jedis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-Jedis基本使用"><span class="nav-number">2.4.1.</span> <span class="nav-text">4-1. Jedis基本使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-Jedis读写Redis数据"><span class="nav-number">2.4.2.</span> <span class="nav-text">4-2. Jedis读写Redis数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第二部分：Redis高级"><span class="nav-number">3.</span> <span class="nav-text">第二部分：Redis高级</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一节：Linux环境部署Redis服务"><span class="nav-number">3.1.</span> <span class="nav-text">第一节：Linux环境部署Redis服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二节：Redis持久化"><span class="nav-number">3.2.</span> <span class="nav-text">第二节：Redis持久化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Redis持久化方案一：RDB"><span class="nav-number">3.2.1.</span> <span class="nav-text">2-1. Redis持久化方案一：RDB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Redis持久化方案二：AOF"><span class="nav-number">3.2.2.</span> <span class="nav-text">2-2. Redis持久化方案二：AOF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Redis持久化AOF：AOF重写"><span class="nav-number">3.2.3.</span> <span class="nav-text">2-3. Redis持久化AOF：AOF重写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Redis持久化RDB与AOF区别"><span class="nav-number">3.2.4.</span> <span class="nav-text">2-4. Redis持久化RDB与AOF区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三节：Redis事务"><span class="nav-number">3.3.</span> <span class="nav-text">第三节：Redis事务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Redis事务-锁"><span class="nav-number">3.3.1.</span> <span class="nav-text">3-1. Redis事务-锁</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第四节：Redis过期数据删除策略"><span class="nav-number">3.4.</span> <span class="nav-text">第四节：Redis过期数据删除策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-删除策略"><span class="nav-number">3.4.1.</span> <span class="nav-text">4-1. 删除策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-逐出算法"><span class="nav-number">3.4.2.</span> <span class="nav-text">4-2. 逐出算法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第五节：Redis-conf基本配置"><span class="nav-number">3.5.</span> <span class="nav-text">第五节：Redis.conf基本配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第六节：Redis高级数据类型"><span class="nav-number">3.6.</span> <span class="nav-text">第六节：Redis高级数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-Bitmaps"><span class="nav-number">3.6.1.</span> <span class="nav-text">6-1. Bitmaps</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-HyperLogLog"><span class="nav-number">3.6.2.</span> <span class="nav-text">6-2. HyperLogLog</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-GEO"><span class="nav-number">3.6.3.</span> <span class="nav-text">6-3. GEO</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第三部分：Redis集群"><span class="nav-number">4.</span> <span class="nav-text">第三部分：Redis集群</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#第一节：主从复制"><span class="nav-number">4.1.</span> <span class="nav-text">第一节：主从复制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-主从复制实现"><span class="nav-number">4.1.1.</span> <span class="nav-text">1-1.    主从复制实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-主从复制常见问题"><span class="nav-number">4.1.2.</span> <span class="nav-text">1-2.    主从复制常见问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二节：哨兵模式"><span class="nav-number">4.2.</span> <span class="nav-text">第二节：哨兵模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-哨兵模式构建"><span class="nav-number">4.2.1.</span> <span class="nav-text">2-1. 哨兵模式构建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-哨兵模式原理"><span class="nav-number">4.2.2.</span> <span class="nav-text">2-2. 哨兵模式原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第三节：Redis集群"><span class="nav-number">4.3.</span> <span class="nav-text">第三节：Redis集群</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Redis集群原理"><span class="nav-number">4.3.1.</span> <span class="nav-text">3-1. Redis集群原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Redis集群搭建"><span class="nav-number">4.3.2.</span> <span class="nav-text">3-2. Redis集群搭建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-Redis集群故障演练"><span class="nav-number">4.3.3.</span> <span class="nav-text">3-3. Redis集群故障演练</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第四部分：企业级解决方案"><span class="nav-number">5.</span> <span class="nav-text">第四部分：企业级解决方案</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-缓存预热"><span class="nav-number">5.1.</span> <span class="nav-text">4-1. 缓存预热</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-缓存雪崩"><span class="nav-number">5.2.</span> <span class="nav-text">4-2. 缓存雪崩</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-缓存击穿"><span class="nav-number">5.3.</span> <span class="nav-text">4-3. 缓存击穿</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-缓存穿透"><span class="nav-number">5.4.</span> <span class="nav-text">4-4. 缓存穿透</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-性能监控"><span class="nav-number">5.5.</span> <span class="nav-text">4-5. 性能监控</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="晓晨"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">晓晨</p>
  <div class="site-description" itemprop="description">乱世浮尘，不堪遥望，唯有情意，晨光依旧</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <script src="https://soyawww.github.io/live2d/autoload.js"></script>
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">晓晨</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
